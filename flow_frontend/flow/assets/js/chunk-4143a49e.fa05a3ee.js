(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4143a49e"],{"9ed6":function(e,t,r){"use strict";r.r(t);var o=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticClass:"my-login-page"},[o("el-row",[o("el-col",{attrs:{span:24,align:"center"}},[o("div",{staticClass:"container h-100"},[o("div",{staticClass:"row justify-content-md-center h-100"},[o("div",{staticClass:"card-wrapper"},[o("div",{staticClass:"brand"},[o("img",{attrs:{src:r("aca7"),alt:"logo"}})]),e._v(" "),o("div",{staticClass:"card fat"},[e.isRetrievePassword?e._e():o("el-form",{ref:"formLogin",attrs:{model:e.formLogin,rules:e.rules}},[o("h2",{staticClass:"card-title"},[e._v("Login")]),e._v(" "),o("el-form-item",{attrs:{label:"用户名",prop:"username"}},[o("el-input",{staticStyle:{width:"80%",float:"right"},attrs:{clearable:"","prefix-icon":"el-icon-user-solid"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.formLogin.username,callback:function(t){e.$set(e.formLogin,"username",t)},expression:"formLogin.username"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"密码",prop:"password"}},[o("el-input",{staticStyle:{width:"80%",float:"right"},attrs:{"show-password":"","prefix-icon":"el-icon-lock"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.formLogin.password,callback:function(t){e.$set(e.formLogin,"password",t)},expression:"formLogin.password"}},[o("template",{slot:"append"},[o("el-button",{on:{click:function(t){return e.retrievePassword()}}},[e._v("\n                                                找回密码\n                                            ")])],1)],2)],1),e._v(" "),o("el-form-item",{attrs:{label:"验证码",prop:"VerificationCode"}},[o("el-input",{staticStyle:{width:"40%",float:"left","margin-left":"22px"},attrs:{"prefix-icon":"el-icon-picture-outline-round"},nativeOn:{keyup:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.login(t)}},model:{value:e.formLogin.code,callback:function(t){e.$set(e.formLogin,"code",t)},expression:"formLogin.code"}}),e._v(" "),o("img",{attrs:{src:e.base64CodeVerificationCode,alt:""},on:{click:function(t){return e.getCaptcha()}}})],1),e._v(" "),o("el-form-item",[o("el-button",{staticStyle:{width:"100%","font-weight":"bold"},attrs:{type:"primary",loading:e.loading},on:{click:e.login}},[e._v("\n                                        登    录\n                                    ")])],1),e._v(" "),o("el-form-item",[e._v("\n                                    还没有账户?\n                                    "),o("router-link",{attrs:{to:"/register"}},[o("el-button",{attrs:{type:""}},[e._v("\n                                            注 册\n                                            "),o("i",{staticClass:"el-icon-arrow-right el-icon--right"})])],1)],1)],1),e._v(" "),e.isRetrievePassword?o("el-form",{attrs:{model:e.formRetrievePassword}},[o("h2",{staticClass:"card-title"},[e._v("Retrieve Password")]),e._v(" "),e.isVerifyPhoneNumber?e._e():o("el-form-item",{attrs:{label:"用户名",prop:"username"}},[o("el-input",{staticStyle:{width:"80%",float:"right"},attrs:{clearable:"","prefix-icon":"el-icon-user-solid"},model:{value:e.formRetrievePassword.username,callback:function(t){e.$set(e.formRetrievePassword,"username",t)},expression:"formRetrievePassword.username"}})],1),e._v(" "),e.isVerifyPhoneNumber?e._e():o("el-form-item",{attrs:{label:"手机号",prop:"phone"}},[o("el-input",{staticStyle:{width:"80%",float:"right"},attrs:{clearable:"","prefix-icon":"el-icon-user-solid"},model:{value:e.formRetrievePassword.phone,callback:function(t){e.$set(e.formRetrievePassword,"phone",t)},expression:"formRetrievePassword.phone"}})],1),e._v(" "),e.isVerifyPhoneNumber?e._e():o("el-form-item",{attrs:{label:"新密码",prop:"password"}},[o("el-input",{staticStyle:{display:"inline-block",width:"80%",float:"right"},attrs:{"show-password":"","prefix-icon":"el-icon-lock"},model:{value:e.formRetrievePassword.password,callback:function(t){e.$set(e.formRetrievePassword,"password",t)},expression:"formRetrievePassword.password"}})],1),e._v(" "),e.isVerifyPhoneNumber?e._e():o("el-form-item",{attrs:{label:"确认密码",prop:"checkPassword"}},[o("el-input",{staticStyle:{display:"inline-block",width:"80%",float:"right"},attrs:{"show-password":"","prefix-icon":"el-icon-lock"},model:{value:e.formRetrievePassword.checkPassword,callback:function(t){e.$set(e.formRetrievePassword,"checkPassword",t)},expression:"formRetrievePassword.checkPassword"}})],1),e._v(" "),e.isVerifyPhoneNumber?e._e():o("el-form-item",{attrs:{label:"验证码",prop:"VerificationCode"}},[o("el-input",{staticStyle:{width:"40%",float:"left","margin-left":"22px"},attrs:{"prefix-icon":"el-icon-picture-outline-round"},model:{value:e.formRetrievePassword.code,callback:function(t){e.$set(e.formRetrievePassword,"code",t)},expression:"formRetrievePassword.code"}}),e._v(" "),o("img",{attrs:{src:e.base64CodeVerificationCode,alt:""},on:{click:function(t){return e.getCaptcha()}}})],1),e._v(" "),e.isVerifyPhoneNumber?e._e():o("el-form-item",[o("el-button",{staticStyle:{width:"100%","font-weight":"bold"},attrs:{type:"primary",loading:e.loading},on:{click:function(t){return e.changePassword()}}},[e._v("\n                                        更改密码\n                                    ")])],1)],1):e._e()],1),e._v(" "),o("div",{staticClass:"footer"},[e._v("Copyright © 2020 — NKAI")])])])])])],1)],1)},i=[],a=(r("ac6a"),r("456d"),r("6b54"),{data:function(){var e=this,t=function(e,t,r){if(!t)return r(new Error("用户名不能为空！"));r()},r=function(e,t,r){if(!t)return r(new Error("密码不能为空！"));r()},o=function(t,r,o){return r?e.formLogin.code!==e.rightVerificationCode?o(new Error("验证码不正确！")):void o():o(new Error("验证码不能为空！"))};return{isRetrievePassword:!1,isVerifyPhoneNumber:!1,phoneNumber:"",access_token:"",rightVerificationCode:"",base64CodeVerificationCode:"",formLogin:{username:"",password:"",code:"",checked:!1,redirect:void 0,otherQuery:{}},formRetrievePassword:{username:"",phone:"",password:"",checkPassword:"",code:""},rules:{username:[{validator:t,trigger:"blur"}],password:[{validator:r,trigger:"blur"}],code:[{validator:o,trigger:"blur"}]},loading:!1}},watch:{$route:{handler:function(e){var t=e.query;t&&(this.redirect=t.redirect,this.otherQuery=this.getOtherQuery(t))},immediate:!0}},methods:{changePassword:function(){var e=this;this.isVerifyPhoneNumber=!0;var t=this.formRetrievePassword,r={username:t.username,phone:t.phone,password:t.password,checkPassword:t.checkPassword,code:t.code,access_token:this.access_token};console.log(r),this.axios({method:"post",url:"http://39.105.21.62/flow/api/user/chapassword",data:r}).then((function(e){alert(e),location.reload()})).catch((function(t){e.$message({message:t,type:"error"})}))},retrievePassword:function(){this.isRetrievePassword=!0},login:function(){var e=this,t=this.formLogin,r={username:t.username,password:t.password,code:t.code,access_token:this.access_token};this.$refs["formLogin"].validate((function(o){if(!o)return e.$message.error("error submit!"),!1;e.loading=!0,e.$store.dispatch("user/Login",r).then((function(){var r=(new Date).getTime()+2592e5;localStorage.setItem("username",t.username),localStorage.setItem("expires",r.toString()),e.loading=!1,e.$router.push({path:"/project"}),location.reload()})).catch((function(t){e.loading=!1}))}))},getOtherQuery:function(e){return Object.keys(e).reduce((function(t,r){return"redirect"!==r&&(t[r]=e[r]),t}),{})},getCaptcha:function(){var e=this;this.axios({method:"get",url:"http://39.105.21.62/flow/api/user/captcha?access_token=".concat((new Date).getTime())}).then((function(t){e.access_token=t.data.data.access_token,e.rightVerificationCode=t.data.data.rightCode,e.base64CodeVerificationCode="data:image/png;base64,".concat(t.data.data.img)})).catch((function(t){e.$message({message:t,type:"error"})}))}},created:function(){this.getCaptcha(),localStorage.removeItem("username"),localStorage.removeItem("expires")}}),s=a,n=(r("b375"),r("2877")),c=Object(n["a"])(s,o,i,!1,null,"7aa2496c",null);t["default"]=c.exports},a2ab:function(e,t,r){},b375:function(e,t,r){"use strict";var o=r("a2ab"),i=r.n(o);i.a}}]);