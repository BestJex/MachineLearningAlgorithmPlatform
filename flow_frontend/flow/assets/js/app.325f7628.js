(function(t){function e(e){for(var a,i,s=e[0],c=e[1],l=e[2],d=0,u=[];d<s.length;d++)i=s[d],o[i]&&u.push(o[i][0]),o[i]=0;for(a in c)Object.prototype.hasOwnProperty.call(c,a)&&(t[a]=c[a]);h&&h(e);while(u.length)u.shift()();return r.push.apply(r,l||[]),n()}function n(){for(var t,e=0;e<r.length;e++){for(var n=r[e],a=!0,i=1;i<n.length;i++){var s=n[i];0!==o[s]&&(a=!1)}a&&(r.splice(e--,1),t=c(c.s=n[0]))}return t}var a={},i={app:0},o={app:0},r=[];function s(t){return c.p+"assets/js/"+({}[t]||t)+"."+{"chunk-25112b8c":"ea71392a","chunk-2db84a18":"fb355bb9","chunk-d09d026a":"5050fbc1","chunk-e48c52a0":"6ce43ab5"}[t]+".js"}function c(e){if(a[e])return a[e].exports;var n=a[e]={i:e,l:!1,exports:{}};return t[e].call(n.exports,n,n.exports,c),n.l=!0,n.exports}c.e=function(t){var e=[],n={"chunk-25112b8c":1,"chunk-2db84a18":1,"chunk-d09d026a":1,"chunk-e48c52a0":1};i[t]?e.push(i[t]):0!==i[t]&&n[t]&&e.push(i[t]=new Promise(function(e,n){for(var a="assets/css/"+({}[t]||t)+"."+{"chunk-25112b8c":"f7a0bccc","chunk-2db84a18":"99db78d5","chunk-d09d026a":"65817ce8","chunk-e48c52a0":"99db78d5"}[t]+".css",o=c.p+a,r=document.getElementsByTagName("link"),s=0;s<r.length;s++){var l=r[s],d=l.getAttribute("data-href")||l.getAttribute("href");if("stylesheet"===l.rel&&(d===a||d===o))return e()}var u=document.getElementsByTagName("style");for(s=0;s<u.length;s++){l=u[s],d=l.getAttribute("data-href");if(d===a||d===o)return e()}var h=document.createElement("link");h.rel="stylesheet",h.type="text/css",h.onload=e,h.onerror=function(e){var a=e&&e.target&&e.target.src||o,r=new Error("Loading CSS chunk "+t+" failed.\n("+a+")");r.code="CSS_CHUNK_LOAD_FAILED",r.request=a,delete i[t],h.parentNode.removeChild(h),n(r)},h.href=o;var p=document.getElementsByTagName("head")[0];p.appendChild(h)}).then(function(){i[t]=0}));var a=o[t];if(0!==a)if(a)e.push(a[2]);else{var r=new Promise(function(e,n){a=o[t]=[e,n]});e.push(a[2]=r);var l,d=document.createElement("script");d.charset="utf-8",d.timeout=120,c.nc&&d.setAttribute("nonce",c.nc),d.src=s(t),l=function(e){d.onerror=d.onload=null,clearTimeout(u);var n=o[t];if(0!==n){if(n){var a=e&&("load"===e.type?"missing":e.type),i=e&&e.target&&e.target.src,r=new Error("Loading chunk "+t+" failed.\n("+a+": "+i+")");r.type=a,r.request=i,n[1](r)}o[t]=void 0}};var u=setTimeout(function(){l({type:"timeout",target:d})},12e4);d.onerror=d.onload=l,document.head.appendChild(d)}return Promise.all(e)},c.m=t,c.c=a,c.d=function(t,e,n){c.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},c.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},c.t=function(t,e){if(1&e&&(t=c(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(c.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)c.d(n,a,function(e){return t[e]}.bind(null,a));return n},c.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return c.d(e,"a",e),e},c.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},c.p="/flow/",c.oe=function(t){throw console.error(t),t};var l=window["webpackJsonp"]=window["webpackJsonp"]||[],d=l.push.bind(l);l.push=e,l=l.slice();for(var u=0;u<l.length;u++)e(l[u]);var h=d;r.push([0,"chunk-vendors"]),n()})({0:function(t,e,n){t.exports=n("56d7")},"027f5":function(t,e,n){"use strict";var a=n("3cff"),i=n.n(a);i.a},"034f":function(t,e,n){"use strict";var a=n("64a9"),i=n.n(a);i.a},"09f0":function(t,e,n){},"0f9a":function(t,e,n){"use strict";n.r(e);var a=n("5f87"),i=n("c24f"),o=n("d23d"),r=n("5c96"),s=n("d6dd"),c={token:a["a"].getToken(),userId:a["a"].getToken()?s["a"].payload_decode(a["a"].getToken()).userId:0,username:a["a"].getToken()?s["a"].payload_decode(a["a"].getToken()).username:""},l={SET_USERNAME:function(t,e){t.username=e},SET_USERID:function(t,e){t.userId=e},SET_TOKEN:function(t,e){t.token=e}},d={Login:function(t,e){var n=t.commit;return new Promise(function(t,s){i["a"].login(e).then(function(e){e=e.data,a["a"].setToken(e.token),n("SET_TOKEN",e.token),n("SET_USERNAME",e.username),n("SET_USERID",e.userId),o["a"].initWebSocket(),t()}).catch(function(t){Object(r["Message"])({message:t.data,type:"error",duration:3e3}),s(t)})})},Register:function(t,e){var n=t.commit;return new Promise(function(t,s){i["a"].register(e).then(function(e){e=e.data,a["a"].setToken(e.token),n("SET_TOKEN",e.token),n("SET_USERNAME",e.username),n("SET_USERID",e.userId),o["a"].initWebSocket(),t()}).catch(function(t){Object(r["Message"])({message:t.data,type:"error",duration:3e3}),s(t)})})},Logout:function(t){var e=t.commit;return new Promise(function(t,n){a["a"].removeToken(),e("SET_TOKEN",null),e("SET_USERNAME",""),e("SET_USERID",0),t()})}};e["default"]={namespaced:!0,state:c,mutations:l,actions:d}},"106c":function(t,e,n){},"16de":function(t,e,n){"use strict";var a=n("1bb4"),i=n.n(a);i.a},1952:function(t,e,n){},"1bb4":function(t,e,n){},"1e31":function(t,e,n){t.exports=n.p+"assets/img/loading.2e8a08bc.svg"},"2fad":function(t,e,n){},"34ab":function(t,e,n){"use strict";var a=n("7959"),i=n.n(a);i.a},"39d4":function(t,e,n){},"3c6d":function(t,e,n){},"3cff":function(t,e,n){},"3f5e":function(t,e,n){"use strict";var a=n("b775");e["a"]={deleteFile:function(t){return Object(a["a"])({url:"/upload_file",method:"delete",params:t})},isFilenamehValid:function(t){return Object(a["a"])({url:"/is_filename_valid",method:"POST",data:t})},getProjectFileList:function(t){return Object(a["a"])({url:"/project_file_list",method:"GET",params:t})},previewCsv:function(t){return Object(a["a"])({url:"/preview_csv",method:"GET",params:t})},previewEcharts:function(t){return Object(a["a"])({url:"/preview_echarts",method:"GET",params:t})},isPreviewValid:function(t){return Object(a["a"])({url:"/is_preview_valid",method:"GET",params:t})},createNode:function(t){return Object(a["a"])({url:"/create_node",method:"post",data:t})}}},"41d6":function(t,e,n){"use strict";n.r(e);var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"mountNode"}},[n("div",{staticClass:"editor"},[n("context-menu"),t._v(" "),n("toolbar"),t._v(" "),n("div",{staticClass:"bottom-container",style:"height:"+t.container_height+"px;"},[n("item-panel"),t._v(" "),n("detail-panel"),t._v(" "),n("minimap"),t._v(" "),n("page")],1)],1),t._v(" "),n("Flow")],1)},i=[],o=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),r=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"toolbar"},[n("transition",{attrs:{name:"el-zoom-in-center"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:!t.isRunning,expression:"!isRunning"}],class:{"delay-5":!t.isRunning}},[n("link",{attrs:{href:"//at.alicdn.com/t/font_598462_3xve1872wizzolxr.css",rel:"stylesheet",type:"text/css"}}),t._v(" "),n("i",{staticClass:"command iconfont icon-undo",class:t.undoList.length>0?"":"disable",attrs:{title:"撤销"},on:{click:t.handleUndo}}),t._v(" "),n("i",{staticClass:"command iconfont icon-redo",class:t.redoList.length>0?"":"disable",attrs:{title:"重做"},on:{click:t.handleRedo}}),t._v(" "),n("span",{staticClass:"separator"}),t._v(" "),n("i",{staticClass:"command iconfont icon-delete-o",class:t.selectedItem.length?"":"disable",attrs:{"data-command":"delete",title:"删除"},on:{click:t.handleDelete}}),t._v(" "),n("span",{staticClass:"separator"}),t._v(" "),n("i",{staticClass:"command iconfont icon-zoom-in-o",attrs:{"data-command":"zoomIn",title:"放大"},on:{click:t.handleZoomIn}}),t._v(" "),n("i",{staticClass:"command iconfont icon-zoom-out-o",attrs:{"data-command":"zoomOut",title:"缩小"},on:{click:t.handleZoomOut}}),t._v(" "),n("i",{staticClass:"command iconfont icon-fit",attrs:{"data-command":"autoZoom",title:"适应画布"},on:{click:t.handleAutoZoom}}),t._v(" "),n("i",{staticClass:"command iconfont icon-actual-size-o",attrs:{"data-command":"resetZoom",title:"实际尺寸"},on:{click:t.handleResetZoom}}),t._v(" "),n("span",{staticClass:"separator"}),t._v(" "),n("i",{staticClass:"command iconfont icon-to-back",class:t.selectedItem.length?"":"disable",attrs:{"data-command":"toBack",title:"层级后置"},on:{click:t.handleToBack}}),t._v(" "),n("i",{staticClass:"command iconfont icon-to-front",class:t.selectedItem.length?"":"disable",attrs:{"data-command":"toFront",title:"层级前置"},on:{click:t.handleToFront}}),t._v(" "),n("span",{staticClass:"separator"}),t._v(" "),n("span",{staticClass:"separator"}),t._v(" "),n("i",{staticClass:"command iconfont icon-select",class:t.multiSelect?"disable":"",attrs:{"data-command":"multiSelect",title:"多选"},on:{click:t.handleMuiltSelect}}),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isShowNodeManage=!0}}},[t._v("新增结点")]),t._v(" "),n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isShowFileManagement=!0}}},[t._v("项目文件管理")]),t._v(" "),n("el-button",{attrs:{disabled:null==t.selectedNodeId,type:"success"},on:{click:t.runNode}},[t._v("运行结点")]),t._v(" "),n("el-button",{attrs:{type:"success"},on:{click:t.runProject}},[t._v("运行项目")])],1)]),t._v(" "),n("transition",{attrs:{name:"el-zoom-in-center"}},[n("div",{directives:[{name:"show",rawName:"v-show",value:t.isRunning,expression:"isRunning"}],class:{"delay-4":t.isRunning,"delay-0":!t.isRunning},staticStyle:{"text-align":"center"}},[n("span",[t._v("正在运行")])])]),t._v(" "),n("el-dialog",{attrs:{"append-to-body":!0,visible:t.isShowFileManagement,"custom-class":"preview-dialog",title:"文件管理"},on:{"update:visible":function(e){t.isShowFileManagement=e}}},[n("file-manage",{attrs:{graph:t.graph}})],1),t._v(" "),n("el-dialog",{attrs:{"append-to-body":!0,visible:t.isShowNodeManage,"custom-class":"preview-dialog",title:"新增结点"},on:{"update:visible":function(e){t.isShowNodeManage=e}}},[n("node-manage")],1)],1)},s=[],c=n("7618"),l=(n("a481"),n("75fc")),d=n("986e"),u=n("1bb5"),h=n.n(u),p=(n("42454"),n("2593"),n("98dc"),n("8103"),function(t,e,n,a){var i=t+n<t?t+n:t,o=t+n>t?t+n:t,r=e+a<e?e+a:e,s=e+a>e?e+a:e;return{x1:i,x2:o,y1:r,y2:s}}),f=n("e74e"),g=n("2f62"),m=n("5c96"),v=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-upload",{staticClass:"upload-demo",attrs:{"before-remove":t.beforeRemove,"before-upload":t.beforeUpload,data:t.uploadData,"file-list":t.fileList,"on-error":t.onUploadErr,"on-remove":t.handleRemove,"on-success":t.onUploadSucc,headers:{Authorization:"JWT "+t.token},accept:".jpg, .csv, .png",action:t.base_api+"upload_file",multiple:""}},[n("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1)],1)},y=[],b=(n("7f7f"),n("3f5e")),_=n("e32a");function w(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function S(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?w(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):w(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var E={name:"file-mange",data:function(){return{uploadData:{graphId:0},base_api:_["a"].BASE_API}},computed:S({},Object(g["b"])(["fileList","token"]),{graphId:{get:function(){return this.$route.params.id||this.$store.getters.graphId}},"uploadData.graphId":{get:function(){return this.$route.params.id||this.$store.getters.graphId}}}),props:{graph:{type:Object,required:!0}},created:function(){this.uploadData.graphId=this.graphId},methods:{handleRemove:function(t,e){var n=this;b["a"].deleteFile({id:t.id}).then(function(t){Object(m["Notification"])({title:"成功",message:"文件移除成功",type:"success",duration:3e3}),n.$store.commit("app/SET_FILELIST",t.data)})},beforeRemove:function(t,e){var n=this;return new Promise(function(e,a){n.$confirm("确定移除 ".concat(t.name,"？")).then(function(e){return b["a"].isFilenamehValid({filename:t.name,graphId:n.graphId})}).then(function(t){t.data?e():(Object(m["Notification"])({title:"错误",message:"文件不存在或文件路径不正确",type:"error",duration:3e3}),a())}).catch(function(t){return a()})})},beforeUpload:function(t){var e=this;return new Promise(function(n,a){b["a"].isFilenamehValid({filename:t.name,graphId:e.graphId}).then(function(a){return a.data?e.$confirm("文件 ".concat(t.name," 已存在，确认覆盖吗？")):(console.log("不存在重名"),n())}).then(function(t){return console.log("确认覆盖"),n()}).catch(function(t){return console.log(t),a()})})},onUploadSucc:function(t,e,n){Object(m["Notification"])({title:"成功",message:"文件上传成功",type:"success",duration:3e3}),this.$store.commit("app/SET_FILELIST",t.data)},onUploadErr:function(t,e,n){console.log(t)}}},O=E,x=n("2877"),I=Object(x["a"])(O,v,y,!1,null,null,null),k=I.exports,P=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"node-manage-container"},[n("div",{staticClass:"step-container"},[n("el-steps",{attrs:{active:t.active,"align-center":""}},[n("el-step",{attrs:{icon:"el-icon-s-operation",title:"选择类别"}}),t._v(" "),n("el-step",{attrs:{icon:"el-icon-edit",title:"编辑模板"}}),t._v(" "),n("el-step",{attrs:{icon:"el-icon-upload",title:"上传脚本"}})],1)],1),t._v(" "),n("div",{staticClass:"form-container"},[n("el-row",{attrs:{justify:"center",type:"flex"}},[n("el-col",{attrs:{span:18}},[n("el-form",{attrs:{"label-position":"top",prop:"Form"}},[n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:0==t.active,expression:"active == 0"}],attrs:{label:"类别",prop:"category"}},[n("el-select",{attrs:{placeholder:"请选择"},model:{value:t.form.selectCategory,callback:function(e){t.$set(t.form,"selectCategory",e)},expression:"form.selectCategory"}},t._l(t.categories,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==t.active,expression:"active == 1"}],attrs:{label:"结点详情"}},[n("div",{staticClass:"detail-container"},[t._l(t.form.nodeDetails,function(e,a){return n("div",{key:a,staticClass:"detail"},[0!=a?n("el-divider"):t._e(),t._v(" "),n("el-row",{attrs:{justify:"space-between",type:"flex"}},[n("el-col",{attrs:{span:11}},[n("el-input",{attrs:{disabled:0==a,placeholder:"detail名称（英文）",size:"small"},model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"nodeDetail.name"}})],1),t._v(" "),n("el-col",{attrs:{span:11}},[n("el-input",{attrs:{disabled:0==a,placeholder:"detail标签",size:"small"},model:{value:e.label,callback:function(n){t.$set(e,"label",n)},expression:"nodeDetail.label"}})],1)],1),t._v(" "),n("el-row",{attrs:{justify:"space-between",type:"flex"}},[n("el-col",{attrs:{span:11}},[n("el-select",{attrs:{disabled:0==a,placeholder:"detail类型",size:"small"},model:{value:e.type,callback:function(n){t.$set(e,"type",n)},expression:"nodeDetail.type"}},t._l(t.typeOptions,function(t){return n("el-option",{key:t,attrs:{label:t,value:t}})}),1)],1),t._v(" "),n("el-col",{attrs:{span:11}},[n("el-input",{attrs:{placeholder:0==a?"结点名称":"默认值",size:"small"},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"nodeDetail.value"}})],1)],1),t._v(" "),0!=a?n("el-button",{staticClass:"delete-detail-btn",attrs:{circle:"",icon:"el-icon-delete"},on:{click:function(e){return t.deleteNodeDetail(a)}}}):t._e()],1)}),t._v(" "),n("div",{staticClass:"add-detail"},[n("el-button",{attrs:{circle:"",icon:"el-icon-circle-plus-outline"},on:{click:t.addNodeDetail}})],1)],2)]),t._v(" "),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:1==t.active,expression:"active == 1"}],attrs:{label:"输入输出"}},[n("div",{staticClass:"point-container"},[t._l(t.form.pointDetails,function(e,a){return n("div",{key:a,staticClass:"detail"},[0!=a?n("el-divider"):t._e(),t._v(" "),n("el-row",{attrs:{justify:"space-between",type:"flex"}},[n("el-col",{attrs:{span:11}},[n("el-input",{attrs:{placeholder:"detail名称（英文）",size:"small"},model:{value:e.name,callback:function(n){t.$set(e,"name",n)},expression:"pointDetail.name"}})],1),t._v(" "),n("el-col",{attrs:{span:11}},[n("el-select",{attrs:{placeholder:"detail类型",size:"small"},model:{value:e.type,callback:function(n){t.$set(e,"type",n)},expression:"pointDetail.type"}},[n("el-option",{attrs:{label:"input",value:"input"}}),t._v(" "),n("el-option",{attrs:{label:"output",value:"output"}})],1)],1)],1),t._v(" "),0!=a?n("el-button",{staticClass:"delete-detail-btn",attrs:{circle:"",icon:"el-icon-delete"},on:{click:function(e){return t.deletePointDetail(a)}}}):t._e()],1)}),t._v(" "),n("div",{staticClass:"add-detail"},[n("el-button",{attrs:{circle:"",icon:"el-icon-circle-plus-outline"},on:{click:t.addPointDetail}})],1)],2)]),t._v(" "),n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:2==t.active,expression:"active == 2"}],attrs:{label:"上传脚本"}},[n("el-input",{staticStyle:{width:"70%","margin-bottom":"20px"},attrs:{placeholder:"脚本名"},model:{value:t.filename,callback:function(e){t.filename=e},expression:"filename"}},[n("template",{slot:"append"},[t._v(".txt")])],2),t._v(" "),n("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{"auto-upload":!1,data:t.uploadDate,"file-list":t.fileList,limit:1,"on-error":t.onUploadErr,"on-exceed":t.handleExceed,"on-success":t.onUploadSucc,accept:".txt",action:t.base_api+"script_manage",headers:{Authorization:"JWT "+t.token}}},[n("el-button",{attrs:{size:"small",type:"primary"}},[t._v("选取脚本")])],1)],1)],1)],1)],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer"},[0!=this.active?n("el-button",{staticStyle:{"margin-top":"12px"},attrs:{size:"small",type:"primary"},on:{click:t.prev}},[t._v("上 一 步")]):t._e(),t._v(" "),this.active!=this.countStep-1?n("el-button",{staticStyle:{"margin-top":"12px"},attrs:{size:"small",type:"primary"},on:{click:t.next}},[t._v("下 一 步")]):t._e(),t._v(" "),this.active==this.countStep-1?n("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-top":"12px"},attrs:{size:"small",type:"success"},on:{click:t.save}},[t._v("完 成")]):t._e()],1)])},A=[];function D(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function j(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?D(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):D(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var C={data:function(){return{countStep:3,active:0,typeOptions:["input","slider","checkbox","inputNumber","selectFile","download","preview","visualization"],form:{selectCategory:9,nodeDetails:[{name:"name",type:"input",label:"名称",value:""}],pointDetails:[{name:"",type:""}]},filename:"",uploadDate:{selectCategory:-1,filename:""},fileList:[],loading:!1,base_api:_["a"].BASE_API}},computed:j({},Object(g["b"])(["categories","token"])),watch:{form:{handler:function(){this.shouldDisabledNext()}}},methods:{next:function(){this.shouldDisabledNext()?this.active<this.countStep&&this.active++:this.$message.warning("存在空缺值")},prev:function(){0!=this.active&&this.active--},addNodeDetail:function(){var t={name:"",type:"",label:"",value:""};this.form.nodeDetails.push(t)},addPointDetail:function(){var t={name:"",type:""};this.form.pointDetails.push(t)},deleteNodeDetail:function(t){this.form.nodeDetails.splice(t,1)},deletePointDetail:function(t){this.form.pointDetails.splice(t,1)},handleExceed:function(t,e){Object(m["Notification"])({title:"警告",message:"当前限制选择 1 个文件，本次选择了 ".concat(t.length," 个文件，共选择了 ").concat(t.length+e.length," 个文件"),type:"warning",duration:3e3})},shouldDisabledNext:function(){if(0==this.active)return""!=this.form.selectCategory;if(1==this.active){var t=this.form.nodeDetails;for(var e in t)for(var n in t[e])if(""==t[e][n])return!1;var a=this.form.pointDetails;for(var i in a)for(var n in a[i])if(""==a[i][n])return!1;return!0}},save:function(){""!=this.filename?(this.uploadDate.filename=this.filename+".txt",this.uploadDate.selectCategory=this.form.selectCategory,this.loading=!0,this.$refs.upload.submit()):this.$message.warning("存在空缺值")},onUploadSucc:function(){var t=this;this.form.name=this.form.nodeDetails[0].value,this.form.raw_script_name=this.filename+".txt",this.form.shape="customNode",this.form.size="170*34",this.form.color="#1890ff";var e=this.form.pointDetails,n=0,a=0;for(var i in e)"input"==e[i].type?n++:a++;var o=1/(n+1),r=1/(a+1),s=1,c=1;for(var i in e)"input"==e[i].type?e[i]["proportion"]=o*s++:e[i]["proportion"]=r*c++;b["a"].createNode(this.form).then(function(e){t.loading=!1,t.reset(),t.$store.dispatch("app/getNodeList"),t.$store.commit("app/SET_ISSHOWNODEMANAGE",!1)}).catch(function(e){console.log(e),t.loading=!1})},reset:function(){this.active=0,this.form.selectCategory=8,this.form.nodeDetails=[{name:"name",type:"input",label:"名称",value:""}],this.form.pointDetails=[{name:"",type:""}],this.filename="",this.uploadDate.filename="",this.uploadDate.selectCategory=-1,this.fileList=[]},onUploadErr:function(t,e,n){console.log(t),this.loading=!1}}},T=C,M=(n("6763"),Object(x["a"])(T,P,A,!1,null,"18e85808",null)),N=M.exports;function L(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function W(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?L(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):L(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var B={data:function(){return{page:{},graph:{},redoList:[],undoList:[],editor:null,command:null,selectedItem:[],multiSelect:!1,addGroup:!1,isShowFileManagement:!1,max_id:0}},computed:W({},Object(g["b"])(["isAllowSave","selectedNodeId"]),{isRunning:{get:function(){return this.$store.state.app.is_running},set:function(t){this.$store.commit("app/SET_ISRUNNING",t)}},isShowNodeManage:{get:function(){return this.$store.state.app.is_show_node_manage},set:function(t){this.$store.commit("app/SET_ISSHOWNODEMANAGE",t)}},graphId:{get:function(){return this.$route.params.id||this.$store.getters.graphId}}}),components:{fileManage:k,nodeManage:N},created:function(){this.init(),this.bindEvent()},watch:{selectedItem:function(t){t&&t.length>1?this.addGroup=!0:this.addGroup=!1}},methods:{init:function(){var t=this.$parent,e=t.editor,n=t.command;this.editor=e,this.command=n},bindEvent:function(){var t=this,e=this;d["a"].$on("afterAddPage",function(t){e.page=t,e.graph=e.page.graph}),d["a"].$on("add",function(e){t.redoList=e.redoList,t.undoList=e.undoList}),d["a"].$on("update",function(e){t.redoList=e.redoList,t.undoList=e.undoList}),d["a"].$on("delete",function(e){t.redoList=e.redoList,t.undoList=e.undoList}),d["a"].$on("updateItem",function(e){t.command.executeCommand("update",[e])}),d["a"].$on("addItem",function(e){t.command.executeCommand("add",[e])}),d["a"].$on("nodeselectchange",function(){var e;t.selectedItem=t.graph.findAllByState("node","selected"),t.selectedItem=(e=t.selectedItem).concat.apply(e,Object(l["a"])(t.graph.findAllByState("edge","selected")))}),d["a"].$on("deleteItem",function(){t.handleDelete()}),d["a"].$on("muliteSelectEnd",function(){t.multiSelect=!1,t.selectedItem=t.graph.findAllByState("node","selected")}),d["a"].$on("undo",function(){t.handleUndo()}),d["a"].$on("redo",function(){t.handleRedo()}),d["a"].$on("save",function(){t.handleSave()}),d["a"].$on("selectAll",function(){t.handleSelectAll()})},handleUndo:function(){this.undoList.length>0&&this.command.undo()},handleRedo:function(){this.redoList.length>0&&this.command.redo()},forEach:function(t){for(var e in t)"id"===e&&"string"===typeof t[e]&&(this.max_id=Math.max(this.max_id,parseInt(t[e].replace(/[^0-9]/gi,"")))),"object"==Object(c["a"])(t[e])&&null!==t[e]&&this.forEach(t[e])},handleSave:function(){var t=this;if(this.isAllowSave){this.$store.commit("app/SET_ALLOWSAVE",!1);var e=this.$loading({lock:!0,text:"保存中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.8)"}),n=this.graph.save();Object.assign(n,{id:this.graphId}),f["a"].sendGraph({graph:JSON.stringify(n)}).then(function(t){Object(m["Notification"])({title:"成功",message:"保存成功",type:"success",duration:3e3})}).then(function(){return f["a"].getGraphById({graphId:t.graphId})}).then(function(n){var a=n.data;t.forEach(a),t.$store.commit("app/SET_MAXID",t.max_id),t.graph.read(a),a.nodes.length&&t.graph.fitView(100),e.close()}).catch(function(t){e.close(),Object(m["Notification"])({title:"错误",message:t,type:"error",duration:3e3})})}},handleDelete:function(){this.selectedItem.length>0&&(this.command.executeCommand("delete",this.selectedItem),this.selectedItem=[])},getFormatPadding:function(){return h.a.formatPadding(this.graph.get("fitViewPadding"))},getViewCenter:function(){var t=this.getFormatPadding(),e=this.graph,n=this.graph.get("width"),a=e.get("height");return{x:(n-t[2]-t[3])/2+t[3],y:(a-t[0]-t[2])/2+t[0]}},handleZoomIn:function(){var t=this.graph.getZoom();this.graph.zoomTo(t+.5,this.getViewCenter())},handleZoomOut:function(){var t=this.graph.getZoom();this.graph.zoomTo(t-.5,this.getViewCenter())},handleToBack:function(){var t=this;this.selectedItem&&this.selectedItem.length>0&&this.selectedItem.forEach(function(e){e.toBack(),t.graph.paint()})},handleToFront:function(){var t=this;this.selectedItem&&this.selectedItem.length>0&&this.selectedItem.forEach(function(e){"edge"===e.getType()||e.toFront(),t.graph.paint()})},handleAutoZoom:function(){this.graph.fitView(20)},handleResetZoom:function(){this.graph.zoomTo(1,this.getViewCenter())},handleMuiltSelect:function(){this.multiSelect=!0,this.graph.setMode("multiSelect")},handleAddGroup:function(){},getPosition:function(t){var e,n,a,i,o=[];t.forEach(function(t){var e=t.getBBox();o.push(p(e.x,e.y,e.width,e.height))}),o.forEach(function(t){"undefined"==typeof e&&(e=t.x1),"undefined"==typeof n&&(n=t.y1),"undefined"==typeof a&&(a=t.x2),"undefined"==typeof i&&(i=t.y2),e>t.x1&&(e=t.x1),n>t.y1&&(n=t.y1),a<t.x2&&(a=t.x2),i<t.y2&&(i=t.y2)}),this.$store.dispatch("app/uniqueId");var r=a-e,s=i-n,c=e+r/2,l=n+s/2,d="team"+this.$store.state.app.max_id,u={id:d,width:r,height:s,x:c,y:l,shape:"teamNode"};this.command.executeCommand("add",u)},handleSelectAll:function(){var t=this,e=this.graph.findAll("node",function(t){return!0});h.a.each(e,function(e){t.graph.setItemState(e,"selected",!0)});var n=this.graph.findAll("edge",function(t){return!0});h.a.each(n,function(e){t.graph.setItemState(e,"selected",!0)}),this.selectedItem=e,console.log(this.selectedItem),this.graph.paint()},consoleData:function(){var t=this.graph.save();Object.assign(t,{id:1}),console.log(JSON.stringify(t))},runProject:function(){var t=this,e=this.graph.save();Object.assign(e,{id:this.graphId}),f["a"].runProject({graph:JSON.stringify(e)}).then(function(e){console.log("正在运行"),t.isRunning=!0}).catch(function(e){Object(m["Notification"])({title:"错误",message:e.data,type:"error",duration:3e3}),t.isRunning=!1})},runNode:function(){var t=this,e=this.graph.save();Object.assign(e,{id:this.graphId}),f["a"].runNode({graph:JSON.stringify(e),nodeId:this.selectedNodeId}).then(function(e){console.log("正在运行"),t.isRunning=!0}).catch(function(e){Object(m["Notification"])({title:"错误",message:e.data,type:"error",duration:3e3}),t.isRunning=!1})},addNode:function(){}}},U=B,F=(n("ea21"),Object(x["a"])(U,r,s,!1,null,"17fe2422",null)),H=F.exports,z=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"resizer",style:"left:"+t.itemWidth+"px;",attrs:{id:"item-resizer"},on:{mousedown:t.onResizeMouseDown}}),t._v(" "),n("div",{staticClass:"itempannel",style:"width:"+t.itemWidth+"px;",attrs:{id:"itempannel"}},[n("Item")],1)])},R=[],X=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("el-tree",{attrs:{"allow-drag":t.allowDrag,"allow-drop":t.allowDrop,data:t.nodeList,props:t.defaultProps,"default-expand-all":"",draggable:""},on:{"node-drag-end":t.handleElDragEnd,"node-drag-start":t.handleElDragStart}})],1)},$=[],K=(n("c5f6"),n("28a5"),n("86d5")),G=n.n(K),V=n("fecb"),Q=n.n(V),q={tree_list:[{is_menu:!0,name:"文件处理",children:[{name:"上传文件",size:"170*34",type:"node",shape:"customNode",color:"#1890ff",image:"https://gw.alipayobjects.com/zos/rmsportal/czNEJAmyDpclFaSucYWB.svg",stateImage:Q.a,node_detail:[{type:"input",name:"name",label:"名称",value:"上传文件"},{type:"upload",name:"upload",label:"上传",value:[]}],point_detail:[{type:"output",proportion:.5,func:""}]}]},{is_menu:!0,name:"聚类算法",children:[{name:"K-means",size:"170*34",type:"node",shape:"customNode",color:"#1890ff",image:"https://gw.alipayobjects.com/zos/rmsportal/czNEJAmyDpclFaSucYWB.svg",stateImage:Q.a,node_detail:[{type:"input",name:"name",label:"名称",value:"K-means"},{type:"inputNumber",name:"k_size",label:"K（簇数）",value:1}],point_detail:[{type:"input",proportion:.5,func:""},{type:"output",proportion:.5,func:""}]}]},{is_menu:!0,name:"图形化",children:[{name:"csv显示",size:"170*34",type:"node",shape:"customNode",color:"#1890ff",image:"https://gw.alipayobjects.com/zos/rmsportal/czNEJAmyDpclFaSucYWB.svg",stateImage:Q.a,node_detail:[{type:"input",name:"name",label:"名称",value:"csv显示"}],point_detail:[{type:"input",proportion:.5,func:""}]}]}],_tree_list:[{name:"朴素贝叶斯",label:"朴素贝叶斯",is_menu:!0,children:[{name:"背景图片节点",label:"背景图片节点",size:"170*34",type:"node",x:0,y:0,shape:"customNode",color:"#1890ff",image:"https://gw.alipayobjects.com/zos/rmsportal/czNEJAmyDpclFaSucYWB.svg",stateImage:Q.a,backImage:G.a,inPoints:[[0,.5]],outPoints:[[1,.5]],node_detail:[{type:"input",name:"name",label:"名称",value:"背景图片节点"},{type:"input",name:"path",label:"路径",value:"C:/Users/Chris/Document"},{type:"slider",name:"size",label:"大小",value:0}],point_detail:[{type:"input",proportion:.5,func:"select-all"},{type:"output",proportion:.5,func:"select-all"}]}]},{name:"文件处理",label:"文件处理",is_menu:!0,children:[{name:"上传文件",label:"上传文件",size:"170*34",type:"node",x:0,y:0,shape:"customNode",color:"#1890ff",image:"https://gw.alipayobjects.com/zos/rmsportal/czNEJAmyDpclFaSucYWB.svg",stateImage:Q.a,inPoints:[[0,.5]],outPoints:[[1,.5]],isDoingStart:!0,node_detail:[{type:"input",name:"name",label:"名称",value:"上传文件"},{type:"input",name:"path",label:"路径",value:"C:/Users/Chris/Document"},{type:"slider",name:"size",label:"大小",value:0},{type:"upload",name:"upload",label:"上传",value:[{name:"IMG_3857.JPG",path:"C:/Users/Chris/Document/IMG_3857.JPG"}]}],point_detail:[{type:"input",proportion:.5,func:"select-all"},{type:"output",proportion:.5,func:"select-all"}]},{name:"双输出节点",label:"双输出节点",size:"170*34",type:"node",x:0,y:0,shape:"customNode",color:"#1890ff",image:"https://gw.alipayobjects.com/zos/rmsportal/czNEJAmyDpclFaSucYWB.svg",stateImage:Q.a,inPoints:[[0,.5]],outPoints:[[1,.4],[1,.6]],node_detail:[{type:"input",name:"name",label:"名称",value:"双输出节点"},{type:"input",name:"path",label:"路径",value:"C:/Users/Chris/Document"},{type:"slider",name:"size",label:"大小",value:0}],point_detail:[{type:"input",proportion:.5,func:"select-all"},{type:"output",proportion:.4,func:"select-all"},{type:"output",proportion:.6,func:"select-all"}]},{name:"大型节点",label:"大型节点",size:"340*34",type:"node",x:0,y:0,shape:"customNode",color:"#1890ff",image:"https://gw.alipayobjects.com/zos/rmsportal/czNEJAmyDpclFaSucYWB.svg",stateImage:Q.a,inPoints:[[0,.5]],outPoints:[[1,.5]],node_detail:[{type:"input",name:"name",label:"名称",value:"大型节点"},{type:"input",name:"path",label:"路径",value:"C:/Users/Chris/Document"},{type:"slider",name:"size",label:"大小",value:0}],point_detail:[{type:"input",proportion:.5,func:"select-all"},{type:"output",proportion:.5,func:"select-all"}]}]}]};function Y(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Y(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Y(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var Z={data:function(){return{page:null,command:null,offsetX:0,offsetY:0,tree_list:q.tree_list,defaultProps:{children:"children",label:"name"}}},computed:J({},Object(g["b"])(["isAllowDrop","nodeList"])),created:function(){this.bindEvent()},methods:{handleElDragStart:function(t,e){this.offsetX=e.offsetX,this.offsetY=e.offsetY},handleElDragEnd:function(t,e,n,a){if(this.isAllowDrop){var i=JSON.parse(JSON.stringify(t.data));i.template_id=i.id;var o={};if(Object.assign(o,i),this.page){var r=this.page.graph,s=r.getPointByClient(a.x,a.y);o.x=s.x,o.y=s.y,o.size=i.size.split("*").map(Number),o.type="node",this.command.executeCommand("add",[o])}this.$store.commit("app/SET_ALLOWDROP",!1)}},allowDrag:function(t){return!t.data.is_menu},allowDrop:function(t,e,n){return!1},bindEvent:function(){var t=this;d["a"].$on("afterAddPage",function(e){t.page=e,t.command=e.command})}}},tt=Z,et=(n("4691"),n("8301"),Object(x["a"])(tt,X,$,!1,null,"5f92fbf8",null)),nt=et.exports,at={components:{Item:nt},data:function(){return{page:null,command:null,isActive:!1,startX:0,endX:0,DEFAULT_ITEM_WIDTH:200,DEFAULT_RESIZER_LEFT:190,MAX_ITEM_WIDTH:400,MIN_ITEM_WIDTH:180}},computed:{itemWidth:{get:function(){return this.$store.getters.itemWidth},set:function(t){this.$store.dispatch("app/setItemPannelWidth",t)}}},created:function(){this.bindEvent()},methods:{bindEvent:function(){var t=this;d["a"].$on("afterAddPage",function(e){t.page=e})},onResizeMouseDown:function(t){var e=this;this.isActive=!0,this.startX=t.clientX;var n=document.getElementById("itempannel"),a=document.getElementById("item-resizer"),i=this.itemWidth;document.onmousemove=function(t){e.onResizeMouseMove(t,i,n,a)},document.onmouseup=function(t){e.isActive=!1;var a=parseInt(n.style.width.replace("px",""));a!==e.itemWidth&&(e.itemWidth=a)}},onResizeMouseMove:function(t,e,n,a){if(0===t.witch&&(this.isActive=!1),this.isActive){this.endX=t.clientX;var i=parseInt(n.style.width.replace("px",""));i<=this.MAX_ITEM_WIDTH&&i>=this.MIN_ITEM_WIDTH&&(n.style.width=e-this.startX+this.endX+"px",a.style.left=e-this.startX+this.endX+"px"),i=parseInt(n.style.width.replace("px",""));var o=parseInt(a.style.left.replace("px",""));i>this.MAX_ITEM_WIDTH?(n.style.width="".concat(this.MAX_ITEM_WIDTH,"px"),a.style.left="".concat(this.MAX_ITEM_WIDTH-10,"px")):(i<this.MIN_ITEM_WIDTH||o<this.MIN_ITEM_WIDTH)&&(n.style.width="".concat(this.MIN_ITEM_WIDTH,"px"),a.style.left="".concat(this.MIN_ITEM_WIDTH-10,"px"),a.style.left="".concat(this.MIN_ITEM_WIDTH-10,"px"))}}}},it=at,ot=(n("6f04"),Object(x["a"])(it,z,R,!1,null,"736e1765",null)),rt=ot.exports,st=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("div",{staticClass:"resizer",style:"right:"+t.detailWidth+"px;",attrs:{id:"detail-resizer"},on:{mousedown:t.onResizeMouseDown}}),t._v(" "),n("div",{staticClass:"detailpannel",style:"width:"+t.detailWidth+"px;",attrs:{id:"detailpannel"},on:{mousedown:t.clickDetailPanel}},[n("detail")],1)])},ct=[],lt=n("3820"),dt=n.n(lt),ut=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",["node-selected"==t.status?n("div",{staticClass:"pannel",attrs:{id:"node_detailpannel"}},[n("div",{staticClass:"pannel-title"},[t._v("模型详情")]),t._v(" "),n("div",{staticClass:"block-container"},[n("el-scrollbar",{staticClass:"scroll-container",attrs:{native:!1,noresize:!0}},[n("el-form",{staticClass:"form",style:"max-height: "+(t.docHeight-380)+"px;",attrs:{"label-position":"top"}},[t._l(t.node_detail,function(e){return n("el-form-item",{key:e.label,attrs:{label:e.label,prop:"node.name"}},["input"===e.type?n("el-input",{attrs:{type:"text"},on:{change:t.changeValue},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"node.value"}}):t._e(),t._v(" "),"slider"===e.type?n("el-slider",{attrs:{"input-size":"mini","show-input":""},on:{change:t.changeValue},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"node.value"}}):t._e(),t._v(" "),"inputNumber"===e.type?n("el-input-number",{on:{change:t.changeValue},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"node.value"}}):t._e(),t._v(" "),"checkbox"===e.type?n("el-checkbox",{on:{change:t.changeValue},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"node.value"}}):t._e(),t._v(" "),"selectFile"==e.type?n("el-select",{attrs:{placeholder:"请选择"},on:{change:t.changeValue},model:{value:e.value,callback:function(n){t.$set(e,"value",n)},expression:"node.value"}},t._l(t.fileList,function(t){return n("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1):t._e(),t._v(" "),"download"===e.type?n("div",{staticStyle:{"text-align":"center"}},[n("el-button",{attrs:{plain:"",type:"info"},on:{click:t.downloadFile}},[t._v(t._s(e.label))])],1):t._e(),t._v(" "),"preview"==e.type?n("detail-preview",{attrs:{node_id:t.item.getModel().id}}):t._e(),t._v(" "),"visualization"==e.type?n("visual-file",{directives:[{name:"show",rawName:"v-show",value:!t.isShowEcharts,expression:"!isShowEcharts"}],attrs:{node_id:t.item.getModel().id}}):t._e()],1)}),t._v(" "),t._l(t.point_detail,function(e,a){return n("el-form-item",{directives:[{name:"show",rawName:"v-show",value:"output"===e.type,expression:"point.type === 'output'"}],key:e.id,attrs:{label:"输出"+a}},[n("el-select",{attrs:{placeholder:"请选择"},on:{change:t.changeValue},model:{value:e.func,callback:function(n){t.$set(e,"func",n)},expression:"point.func"}},t._l(t.point_options,function(t){return n("el-option",{key:t.id,attrs:{label:t.value,value:t.value}})}),1)],1)})],2)],1)],1)]):t._e(),t._v(" "),"canvas-selected"===t.status?n("div",{staticClass:"pannel",attrs:{id:"canvas_detailpannel"}},[n("div",{staticClass:"pannel-title"},[t._v("画布")]),t._v(" "),n("div",{staticClass:"block-container"},[n("el-checkbox",{on:{change:t.changeGridState},model:{value:t.showGrid,callback:function(e){t.showGrid=e},expression:"showGrid"}},[t._v("网格对齐")])],1)]):t._e()])},ht=[],pt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"preview-container"},[n("el-tooltip",{attrs:{disabled:t.canPreview,effect:"dark",placement:"left"}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("p",[t._v("当前节点未保存或预览文件不存在")])]),t._v(" "),n("div",{staticStyle:{display:"inline-block"}},[n("el-button",{attrs:{disabled:!t.canPreview,small:"",type:"primary"},on:{click:function(e){t.isShowPreview=!0}}},[t._v("预览文件")])],1)]),t._v(" "),n("el-dialog",{attrs:{"append-to-body":!1,"close-on-click-modal":!1,modal:!1,"modal-append-to-body":!0,visible:t.isShowPreview,"custom-class":"preview-dialog",title:"预览文件"},on:{"update:visible":function(e){t.isShowPreview=e}}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.csv,border:"","highlight-current-row":""}},[n("el-table-column",{attrs:{index:t.indexMethod,"show-overflow-tooltip":!0,label:"\\",type:"index"}}),t._v(" "),t._l(t.csv[0],function(e,a){return n("el-table-column",{key:a,attrs:{label:String(a+1),"show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row[a]))])]}}],null,!0)})})],2)],1)],1)},ft=[],gt={name:"detail-preview",props:{node_id:{type:String}},data:function(){return{csv:[[1,3,!0,4,5,8],[2,1,!1,1,3,0],[3,1,!1,2,1,1],[9,1,!0,1,2,0],[7,4,!0,2,5,2]],index:[],loading:!1,canPreview:!1}},created:function(){var t=this;null==this.node_id?this.canPreview=!1:b["a"].isPreviewValid({nodeId:this.node_id,graphId:this.graphId}).then(function(e){t.canPreview=e.data})},computed:{isShowPreview:{get:function(){var t=this,e=this.$store.getters.isShowPreview;return e&&(this.loading=!0,console.log(this.node_id),b["a"].previewCsv({nodeId:this.node_id,graphId:this.graphId}).then(function(e){t.csv=e.data,t.index=e.index,t.loading=!1}).catch(function(e){t.loading=!1,t.isShowPreview=!1,Object(m["Notification"])({title:"错误",message:"文件不存在或文件路径不正确",type:"error",duration:3e3})})),e},set:function(t){this.$store.commit("app/SET_ISSHOWPREVIEW",t)}},graphId:{get:function(){return this.$route.params.id||this.$store.getters.graphId}}},methods:{indexMethod:function(t){return this.index[t]},previewCsv:function(){var t=this;b["a"].previewCsv({fid:1}).then(function(e){t.csv=e.data}).catch(function(t){Object(m["Notification"])({title:"错误",message:"文件不存在或文件路径不正确",type:"error",duration:3e3})})}}},mt=gt,vt=Object(x["a"])(mt,pt,ft,!1,null,null,null),yt=vt.exports,bt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"visual-container"},[n("el-tooltip",{attrs:{disabled:t.canPreview,effect:"dark",placement:"left"}},[n("div",{attrs:{slot:"content"},slot:"content"},[n("p",[t._v("当前节点未保存或预览文件不存在")])]),t._v(" "),n("div",{staticStyle:{display:"inline-block"}},[n("el-button",{attrs:{disabled:!t.canPreview,small:"",type:"primary"},on:{click:function(e){t.isShowVisual=!0}}},[t._v("可视化文件")])],1)]),t._v(" "),n("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!0,modal:!0,"modal-append-to-body":!0,visible:t.isShowVisual,"custom-class":"preview-dialog",title:"可视化文件"},on:{"update:visible":function(e){t.isShowVisual=e}}},[n("el-form",{attrs:{"label-position":"top"}},[n("el-form-item",{attrs:{label:"选择可视化行（暂不支持字符类型可视化）"}},[n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.csv,border:"","highlight-current-row":""},on:{"selection-change":t.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),t._l(t.index,function(e,a){return n("el-table-column",{key:a,attrs:{label:e,"show-overflow-tooltip":!0},scopedSlots:t._u([{key:"default",fn:function(e){return[n("span",[t._v(t._s(e.row[a]))])]}}],null,!0)})})],2)],1)],1),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"plain"},on:{click:function(e){t.isShowVisual=!1}}},[t._v("取 消")]),t._v(" "),n("el-button",{attrs:{disabled:!t.canProceed,type:"primary"},on:{click:function(e){t.isShowEcharts=!0}}},[t._v("下 一 步")])],1)],1),t._v(" "),t.isShowEcharts?n("visualize-echarts",{attrs:{seclectedCol:t.multipleSelection,pid:t.pid}}):t._e()],1)},_t=[],wt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"visualize-echarts-container"},[n("el-dialog",{attrs:{"append-to-body":!0,"close-on-click-modal":!1,modal:!0,"modal-append-to-body":!0,visible:t.isShowEcharts,"custom-class":"preview-dialog",title:"可视化文件"},on:{"update:visible":function(e){t.isShowEcharts=e}}},[t._l(t.chartDatas,function(t){return n("ve-line",{key:t.id,attrs:{data:t}})}),t._v(" "),n("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(e){t.isShowEcharts=!1}}},[t._v("上 一 步")])],1)],2)],1)},St=[],Et={name:"visualize-echarts",props:{seclectedCol:{type:Array},pid:{type:String}},computed:{isShowEcharts:{get:function(){var t=this.$store.getters.isShowEcharts;return t},set:function(t){this.$store.commit("app/SET_ISSHOWECHARTS",t)}}},data:function(){return{chartDatas:[],graphId:0}},created:function(){var t=this;this.graphId=this.$route.params.id||this.$store.getters.graphId;var e=[];this.seclectedCol.forEach(function(t){e.push(t[0])}),console.log(e),b["a"].previewEcharts({graphId:this.graphId,queries:e,pid:this.pid}).then(function(e){var n=e.data;for(var a in n){var i={},o=[],r=1;n[a].forEach(function(t){var e={};e["Series"]=r++,e["Col ".concat(a)]=t,o.push(e)}),i.id=a,i.columns=["Series","Col ".concat(a)],i.rows=o,t.chartDatas.push(i)}})}},Ot=Et,xt=Object(x["a"])(Ot,wt,St,!1,null,null,null),It=xt.exports,kt={name:"visual-file",props:{node_id:{type:String}},data:function(){return{csv:[[1,3,!0,4,5,8],[2,1,!1,1,3,0],[3,1,!1,2,1,1],[9,1,!0,1,2,0],[7,4,!0,2,5,2]],index:[],loading:!1,canPreview:!1,canProceed:!1,multipleSelection:[],pid:""}},components:{visualizeEcharts:It},created:function(){var t=this;null==this.node_id?this.canPreview=!1:b["a"].isPreviewValid({nodeId:this.node_id,graphId:this.graphId}).then(function(e){t.canPreview=e.data})},computed:{isShowVisual:{get:function(){var t=this,e=this.$store.getters.isShowVisual;return e&&(this.loading=!0,b["a"].previewCsv({nodeId:this.node_id,graphId:this.graphId,transit:!0}).then(function(e){var n=e.data;n.forEach(function(t,e){n[e]=[e+1].concat(t)}),t.csv=n,t.pid=e.pid,t.index=["\\"].concat(e.index),t.loading=!1}).catch(function(e){t.loading=!1,t.isShowPreview=!1,Object(m["Notification"])({title:"错误",message:"文件不存在或文件路径不正确",type:"error",duration:3e3})})),e},set:function(t){this.$store.commit("app/SET_ISSHOWVISUAL",t)}},isShowEcharts:{get:function(){return this.$store.getters.isShowEcharts},set:function(t){this.$store.commit("app/SET_ISSHOWECHARTS",t)}},graphId:{get:function(){return this.$route.params.id||this.$store.getters.graphId}}},methods:{handleSelectionChange:function(t,e){this.multipleSelection=t;var n=!0;t.forEach(function(t){"string"==typeof t[1]&&(n=!1)}),this.canProceed=n}}},Pt=kt,At=Object(x["a"])(Pt,bt,_t,!1,null,null,null),Dt=At.exports;function jt(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function Ct(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?jt(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):jt(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var Tt={data:function(){return{status:"canvas-selected",showGrid:!1,page:{},graph:{},item:{},node_detail:{},point_detail:{},point_options:[{id:1,value:"select-all"},{id:2,value:"random-select"}],grid:null}},computed:Ct({},Object(g["b"])(["fileList","isShowPreview","isShowEcharts","docHeight"]),{graphId:{get:function(){return this.$route.params.id||this.$store.getters.graphId}}}),components:{detailPreview:yt,visualFile:Dt},created:function(){this.init(),this.bindEvent()},methods:{init:function(){},bindEvent:function(){var t=this,e=this;d["a"].$on("afterAddPage",function(n){e.page=n,e.graph=e.page.graph,d["a"].$on("nodeselectchange",function(n){!0===n.select&&"node"===n.target.getType()?(e.status="node-selected",e.item=n.target,console.log(n.target.getModel()),t.$store.commit("app/SET_SETSELECTEDNODEID",n.target.getModel().id),e.node_detail=n.target.getModel().node_detail,e.point_detail=n.target.getModel().point_detail):(e.status="canvas-selected",t.$store.commit("app/SET_SETSELECTEDNODEID",null),e.item=null,e.node=null,e.node_detail=null,e.point_detail=null)})})},downloadFile:function(){location.href="".concat(_["a"].BASE_API,"download_file?graphId=").concat(this.graphId,"&nodeId=").concat(this.item.getModel().id)},changeValue:function(t){var e={node_detail:this.node_detail};this.graph.update(this.item,e)},changeGridState:function(t){t?(this.grid=new dt.a,this.graph.addPlugin(this.grid)):this.graph.removePlugin(this.grid)},saveDetail:function(){var t=this.$loading({lock:!0,text:"保存中",spinner:"el-icon-loading",background:"rgba(0, 0, 0, 0.8)"}),e=this.graph.save();Object.assign(e,{id:this.graphId}),f["a"].sendGraph({graph:JSON.stringify(e)}).then(function(e){t.close()}).catch(function(e){console.error(e),t.close()})}}},Mt=Tt,Nt=(n("16de"),n("34ab"),n("c0fa"),Object(x["a"])(Mt,ut,ht,!1,null,"6dc1bb7d",null)),Lt=Nt.exports,Wt={data:function(){return{status:"canvas-selected",showGrid:!1,page:{},graph:{},item:{},node:{},grid:null,node_detail:[{type:"input",name:"name",label:"名称",value:"动画开始节点"},{type:"input",name:"path",label:"路径",value:"C:/Users/Chris/Document"},{type:"slider",name:"size",label:"大小",value:0}],form:{},isActive:!1,startX:0,endX:0,DEFAULT_DETAIL_WIDTH:200,DEFAULT_RESIZER_RIGHT:200,MAX_DETAIL_WIDTH:400,MIN_DETAIL_WIDTH:180}},components:{detail:Lt},computed:{detailWidth:{get:function(){return this.$store.getters.detailWidth},set:function(t){this.$store.dispatch("app/setDetailPannelWidth",t)}}},methods:{clickDetailPanel:function(){this.$store.dispatch("app/setIsFocusCanvas",!1)},onResizeMouseDown:function(t){var e=this;this.isActive=!0,this.startX=t.clientX;var n=document.getElementById("detailpannel"),a=document.getElementById("detail-resizer"),i=this.detailWidth;document.onmousemove=function(t){e.onResizeMouseMove(t,i,n,a)},document.onmouseup=function(t){e.isActive=!1;var a=parseInt(n.style.width.replace("px",""));a!==e.detailWidth&&(e.detailWidth=a)}},onResizeMouseMove:function(t,e,n,a){if(0===t.witch&&(this.isActive=!1),this.isActive){this.endX=t.clientX;var i=parseInt(n.style.width.replace("px",""));i<=this.MAX_DETAIL_WIDTH&&i>=this.MIN_DETAIL_WIDTH&&(n.style.width=e+this.startX-this.endX+"px",a.style.right=e+this.startX-this.endX+"px"),i=parseInt(n.style.width.replace("px",""));var o=parseInt(a.style.right.replace("px",""));i>this.MAX_DETAIL_WIDTH?(n.style.width="".concat(this.MAX_DETAIL_WIDTH,"px"),a.style.right="".concat(this.MAX_DETAIL_WIDTH,"px")):(i<this.MIN_DETAIL_WIDTH||o<this.MIN_DETAIL_WIDTH)&&(n.style.width="".concat(this.MIN_DETAIL_WIDTH,"px"),a.style.right="".concat(this.MIN_DETAIL_WIDTH,"px"))}}}},Bt=Wt,Ut=(n("eee6"),Object(x["a"])(Bt,st,ct,!1,null,"5385e4cc",null)),Ft=Ut.exports,Ht=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:"width:"+t.detailWidth+"px;",attrs:{id:"navigator"}},[n("div",{staticClass:"pannel-title"},[t._v("导航器")]),t._v(" "),n("div",{ref:"minimap",staticClass:"minimap",attrs:{id:"minimap"}})])},zt=[],Rt=n("027f"),Xt=n.n(Rt);function $t(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function Kt(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?$t(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$t(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var Gt={data:function(){return{minimap:null,graph:null}},computed:Kt({},Object(g["b"])(["detailWidth","canvasWidth","canvasHeight"])),watch:{},created:function(){this.bindEvent()},mounted:function(){var t=this;this.$nextTick(function(){t.initMinmap()})},methods:{initMinmap:function(){var t=this.detailWidth,e=this.detailWidth*this.canvasHeight/this.canvasWidth;e=150;var n={size:[t,e],container:"minimap"};this.minimap=new Xt.a(Kt({},n))},bindEvent:function(){var t=this;d["a"].$on("afterAddPage",function(e){t.graph=e.graph,t.bindPage()})},bindPage:function(){this.minimap&&this.graph&&this.graph.addPlugin(this.minimap)}}},Vt=Gt,Qt=(n("027f5"),Object(x["a"])(Vt,Ht,zt,!1,null,"021ed2c8",null)),qt=Qt.exports,Yt=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{style:"margin-left: "+t.itemWidth+"px; margin-right: "+t.detailWidth+"px; height: 100%;",on:{click:t.clickCanvas,dragover:function(t){t.preventDefault()},drop:t.handleDrop}},[n("span",{staticStyle:{position:"absolute"}},[t._v(t._s(t.canvasWidth))]),t._v(" "),n("div",{staticClass:"graph-container",staticStyle:{position:"relative",height:"100%"},attrs:{id:t.pageId}})])},Jt=[],Zt=n("07cd"),te=n.n(Zt),ee=(n("7514"),{getEvents:function(){return{"node:mouseover":"onMouseover","node:mouseleave":"onMouseleave","node:mousedown":"onMousedown"}},onMouseover:function(t){var e=this,n=t.item,a=e.graph,i=n.getContainer();i.find(function(t){t._attrs.isOutPointText&&t.attr("opacity",.5)}),(t.target._attrs.isOutPointOut||t.target._attrs.isOutPoint)&&(i.find(function(e){(e._attrs.isInPoint||e._attrs.isOutPoint)&&e.attr("fill","#fff"),e._attrs.isOutPoint&&(e._attrs.id===t.target._attrs.parent&&i.find(function(t){t._attrs.id===e._attrs.id&&(t.attr("fill","#1890ff"),t.attr("opacity",1))}),e._attrs.id===t.target._attrs.id&&(e.attr("fill","#1890ff"),e.attr("opacity",1)))}),t.target.attr("cursor","crosshair"),this.graph.paint()),n.hasState("selected")||e.shouldUpdate.call(e,t)&&a.setItemState(n,"hover",!0),a.paint()},onMouseleave:function(t){var e=this,n=t.item,a=e.graph,i=n.getContainer();i.find(function(t){t._attrs.isOutPointText&&t.attr("opacity",0)}),i.find(function(t){(t._attrs.isInPoint||t._attrs.isOutPoint)&&t.attr("fill","#fff")}),e.shouldUpdate.call(e,t)&&(n.hasState("selected")||a.setItemState(n,"hover",!1)),a.paint()},onMousedown:function(t){(t.target._attrs.isOutPoint||t.target._attrs.isOutPointOut)&&this.graph.setMode("addEdge")}}),ne=n("4360"),ae=null,ie=null,oe=null,re={},se=null,ce=null,le={getEvents:function(){return{mousemove:"onMousemove",mouseup:"onMouseup","node:mouseover":"onMouseover","node:mouseleave":"onMouseleave"}},onMouseup:function(t){var e=t.item;if(e&&"node"===e.getType()){var n=e.getContainer();if(t.target._attrs.isInPoint){var a=n._cfg.children;a.map(function(e){e._attrs.isInPointOut&&e._attrs.parent===t.target._attrs.id&&(se=e)}),ce=t.target}else if(t.target._attrs.isInPointOut){se=t.target;var i=n._cfg.children;i.map(function(e){e._attrs.isInPoint&&e._attrs.id===t.target._attrs.parent&&(ce=e)})}if(ce){var o=this.graph.findAll("edge",function(t){return t.getModel().endPointId===ce._attrs.id}),r=ce._cfg.parent.get("item")===oe;if(o.length||!se||r)this.edge&&this.graph.removeItem(this.edge);else{var s=parseInt(ce._attrs.x),c=parseInt(ce._attrs.y);if(re={x:s,y:c},this.edge){this.graph.removeItem(this.edge),ne["a"].dispatch("app/uniqueId");var l={id:"edge"+ne["a"].state.app.max_id,source:oe,target:e,start:ae,end:re,startPointId:ie,endPointId:ce._attrs.id,shape:"customEdge",type:"edge"};console.log("add item"),d["a"].$emit("addItem",l)}}}else this.edge&&this.graph.removeItem(this.edge)}else this.edge&&this.graph.removeItem(this.edge);this.graph.find("node",function(t){var e=t.get("group"),n=e._cfg.children;n.map(function(t){t._attrs.isInPointOut&&(t.attr("opacity","0"),t._attrs.fillStyle="#1890ff"),t._attrs.isInPoint&&t.attr("opacity","0"),t._attrs.isOutPoint&&(t.attr("opacity","0"),t.attr("fill","#fff")),t._attrs.isOutPointText&&t.attr("opacity",0)})}),oe&&this.graph.setItemState(oe,"hover",!1),this.graph.paint(),ae=null,ie=null,oe=null,re={},se=null,ce=null,this.graph.setMode("default")},onMousemove:function(t){var e=this,n=t.item;if(!ae&&t.target._attrs.isOutPoint){var a=parseInt(t.target._attrs.x),i=parseInt(t.target._attrs.y);ae={x:a,y:i},ie=t.target._attrs.parent?t.target._attrs.parent:t.target._attrs.id,console.log(t.target,ae),oe=n,this.graph.find("node",function(t){var n=t.get("group"),a=n._cfg.children;a.map(function(t){var n=t._attrs;n.isInPointOut&&t.attr("opacity","0.3"),n.isInPoint&&t.attr("opacity","1"),t._cfg.parent.get("item")===oe&&(n.isInPointOut||n.isInPoint)&&t.attr("opacity","0"),(n.isInPoint||n.isInPointOut)&&e.graph.find("edge",function(e){var a=e.getModel().endPointId;n.id!==a&&n.parent!==a||(n.isInPointOut,t.attr("opacity","0"))})})}),this.edge=this.graph.addItem("edge",{source:n,target:n,start:ae,end:ae,shape:"link-edge"})}else{var o={x:t.x,y:t.y};this.edge&&this.graph.updateItem(this.edge,{target:o})}},onMouseover:function(t){var e=t.item;e&&"node"===e.getType()&&(t.target._attrs.isInPointOut&&!this.hasTran&&(t.target.transform([["t",0,3],["s",1.2,1.2]]),this.hasTran=!0),this.graph.paint())},onMouseleave:function(){this.graph.find("node",function(t){var e=t.get("group"),n=e._cfg.children;n.map(function(t){t._attrs.isInPointOut&&t.resetMatrix()})}),this.hasTran=!1,this.graph.paint()}},de=(n("ac4d"),n("8a81"),n("2ef0"));function ue(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function he(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ue(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ue(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var pe={fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]},fe=document.body,ge={isDrag:!1,nodeEvent:null,getDefaultCfg:function(){return{updateEdge:!0,delegate:!0,delegateStyle:{}}},getEvents:function(){return{"node:mousedown":"onMousedown",mousemove:"onMousemove",mouseup:"onMouseup","canvas:mouseleave":"onOutOfRange"}},getNode:function(t){var e=this;if(console.log(this.shouldBegin),this.shouldBegin.call(this,t)){this.isDrag=!0,this.nodeEvent=t;var n=t.item,a=this.graph;this.targets=[];var i=a.findAllByState("node","selected"),o=n.get("id"),r=i.filter(function(t){var e=t.get("id");return o===e});0===r.length?this.target=n:i.length>1?i.forEach(function(t){e.targets.push(t)}):this.targets.push(n),this.origin={x:t.x,y:t.y},this.point={},this.originPoint={}}},onMousemove:function(t){this.origin||this.getNode(t),this.isDrag&&this.get("shouldUpdate").call(this,t)&&(this.targets&&this.targets.length>0?this._updateDelegate(t,this.nodeEvent):this._update(this.target,t,this.nodeEvent,!0))},onMouseup:function(t){var e=this;if(this.shape&&(this.shape.remove(),this.shape=null),this.target){var n=this.target.get("delegateShape");n&&(n.remove(),this.target.set("delegateShape",null))}if(this.targets&&this.targets.length>0)this.targets.forEach(function(n){return e._update(n,t)});else if(this.target){var a=this.origin,i=this.target.get("model"),o=this.target.get("id");this.point[o]||(this.point[o]={x:i.x,y:i.y});var r=t.x-a.x+this.point[o].x,s=t.y-a.y+this.point[o].y,c={};c.item=this.target,c.oldModel=this.origin,c.newModel={x:r,y:s},d["a"].$emit("updateItem",c)}this.point={},this.origin=null,this.originPoint={},this.targets&&(this.targets.length=0),this.target=null;var l=this.fn;l&&(fe.removeEventListener("mouseup",l,!1),this.fn=null),this.isDrag=!1,this.nodeEvent=null,this.graph.setMode("default")},onOutOfRange:function(t){var e=this;if(this.origin){var n=e.graph.get("canvas").get("el"),a=function(a){a.target!==n&&e.onDragEnd(t)};this.fn=a,fe.addEventListener("mouseup",a,!1)}},_update:function(t,e,n,a){var i=this.origin,o=t.get("model"),r=t.get("id");this.point[r]||(this.point[r]={x:o.x,y:o.y});var s=e.x-i.x+this.point[r].x,c=e.y-i.y+this.point[r].y;if(a)this._updateDelegate(e,n,s,c);else{var l={x:s,y:c};this.get("updateEdge")?this.graph.updateItem(t,l):(t.updatePosition(l),this.graph.paint())}},_updateDelegate:function(t,e,n,a){var i=e.item.get("keyShape").getBBox();if(!this.shape){var o=this.graph.get("group"),r=Object(de["merge"])({},pe,this.delegateStyle);if(this.targets.length>0){var s=this.calculationGroupPosition(),c=s.x,l=s.y,d=s.width,u=s.height,h=s.minX,p=s.minY;this.originPoint={x:c,y:l,width:d,height:u,minX:h,minY:p},this.shape=o.addShape("rect",{attrs:he({width:d,height:u,x:c,y:l},r)})}else this.target&&(this.shape=o.addShape("rect",{attrs:he({width:i.width,height:i.height,x:n-i.width/2,y:a-i.height/2},r)}),this.target.set("delegateShape",this.shape));this.shape.set("capture",!1)}if(this.targets.length>0){var f=t.x-this.origin.x+this.originPoint.minX,g=t.y-this.origin.y+this.originPoint.minY;this.shape.attr({x:f,y:g})}else this.target&&this.shape.attr({x:n-i.width/2,y:a-i.height/2});this.graph.paint()},calculationGroupPosition:function(){var t=this.graph,e=t.findAllByState("node","selected"),n=[],a=[],i=[],o=[],r=!0,s=!1,c=void 0;try{for(var l,d=e[Symbol.iterator]();!(r=(l=d.next()).done);r=!0){var u=l.value,h=Object(de["isString"])(u)?t.findById(u):u,p=h.getBBox(),f=p.minX,g=p.minY,m=p.maxX,v=p.maxY;n.push(f),i.push(g),a.push(m),o.push(v)}}catch(I){s=!0,c=I}finally{try{r||null==d.return||d.return()}finally{if(s)throw c}}var y=Math.floor(Math.min.apply(Math,n)),b=Math.floor(Math.max.apply(Math,a)),_=Math.floor(Math.min.apply(Math,i)),w=Math.floor(Math.max.apply(Math,o)),S=y-20,E=_+10,O=b-y,x=w-_;return{x:S,y:E,width:O,height:x,minX:y,minY:_}}},me={getDefaultCfg:function(){return{multiple:!0,keyCode:17}},getEvents:function(){return{"node:click":"onClick","canvas:click":"onCanvasClick","canvas:mouseover":"onCanvasMouseover",keyup:"onKeyUp",keydown:"onKeyDown"}},onClick:function(t){var e=this,n=t.item,a=e.graph,i=a.get("autoPaint");a.setAutoPaint(!1);var o=a.findAllByState("edge","selected");if(h.a.each(o,function(t){a.setItemState(t,"selected",!1)}),!e.keydown||!e.multiple){var r=a.findAllByState("node","selected");h.a.each(r,function(t){t!==n&&a.setItemState(t,"selected",!1)})}n.hasState("selected")?(e.shouldUpdate.call(e,t)&&a.setItemState(n,"selected",!1),d["a"].$emit("nodeselectchange",{target:n,select:!1})):(e.shouldUpdate.call(e,t)&&a.setItemState(n,"selected",!0),d["a"].$emit("nodeselectchange",{target:n,select:!0})),a.setAutoPaint(i),a.paint()},onCanvasClick:function(){var t=this.graph,e=t.get("autoPaint");t.setAutoPaint(!1);var n=t.findAllByState("node","selected");h.a.each(n,function(e){t.setItemState(e,"selected",!1),d["a"].$emit("nodeselectchange",{target:e,select:!1})});var a=t.findAllByState("edge","selected");h.a.each(a,function(e){t.setItemState(e,"selected",!1),d["a"].$emit("nodeselectchange",{target:e,select:!1})}),t.paint(),t.setAutoPaint(e)},onCanvasMouseover:function(){var t=this.graph;t.paint()},onKeyDown:function(t){var e=t.keyCode||t.which;e===this.keyCode?this.keydown=!0:this.keydown=!1},onKeyUp:function(){this.keydown=!1}},ve={getEvents:function(){return{"edge:mouseover":"onMouseover","edge:mouseleave":"onMouseleave","edge:click":"onClick"}},onMouseover:function(t){var e=this,n=t.item,a=e.graph;n.hasState("selected")||(e.shouldUpdate.call(e,t)&&a.setItemState(n,"hover",!0),a.paint())},onMouseleave:function(t){var e=this,n=t.item,a=e.graph,i=n.getContainer();i.find(function(t){(t._attrs.isInPoint||t._attrs.isOutPoint)&&t.attr("fill","#fff")}),e.shouldUpdate.call(e,t)&&(n.hasState("selected")||a.setItemState(n,"hover",!1)),a.paint()},onClick:function(t){var e=this,n=t.item,a=e.graph,i=a.get("autoPaint");a.setAutoPaint(!1);var o=a.findAllByState("node","selected");if(h.a.each(o,function(t){a.setItemState(t,"selected",!1)}),!e.keydown||!e.multiple){var r=a.findAllByState("edge","selected");h.a.each(r,function(t){t!==n&&a.setItemState(t,"selected",!1)})}n.hasState("selected")?(e.shouldUpdate.call(e,t)&&a.setItemState(n,"selected",!1),d["a"].$emit("nodeselectchange",{target:n,select:!1})):(e.shouldUpdate.call(e,t)&&a.setItemState(n,"selected",!0),console.log(n,n.getModel()),d["a"].$emit("nodeselectchange",{target:n,select:!0})),a.setAutoPaint(i),a.paint()}},ye={getDefaultCfg:function(){return{keydown:!1,backKeyCode:8,deleteKeyCode:46,shiftKeyCode:16,_a:65,_s:83,_y:89,_z:90}},getEvents:function(){return{keyup:"onKeyUp",keydown:"onKeyDown"}},onKeyDown:function(t){this.keydown=!0;var e=t.keyCode||t.which;if(e&&!ne["a"].state.app.is_running)switch(e){case this.deleteKeyCode:case this.backKeyCode:ne["a"].getters.isFocusCanvas&&d["a"].$emit("deleteItem");break;case this._a:t.ctrlKey&&d["a"].$emit("selectAll");break;case this._s:t.ctrlKey&&(t.preventDefault(),d["a"].$emit("save"));break;case this._y:t.ctrlKey&&d["a"].$emit("redo");break;case this._z:t.ctrlKey&&d["a"].$emit("undo");break}},onKeyUp:function(){this.keydown=!1,ne["a"].state.app.is_running||ne["a"].commit("app/SET_ALLOWSAVE",!0)}},be={version:"0.0.1-beat",rootContainerClassName:"root-container",nodeContainerClassName:"node-container",edgeContainerClassName:"edge-container",groupContainerClassName:"group-container",defaultNode:{shape:"circle",style:{fill:"#fff"},size:40,color:"#333"},defaultEdge:{shape:"line",style:{},size:1,color:"#333"},nodeLabel:{style:{fill:"#595959",textAlign:"center",textBaseline:"middle"},offset:5},edgeLabel:{style:{fill:"#595959",textAlign:"center",textBaseline:"middle"}},nodeStateStyle:{active:{fillOpacity:.8},selected:{lineWidth:2}},edgeStateStyle:{active:{strokeOpacity:.8},selected:{lineWidth:2}},loopPosition:"top",delegateStyle:{fill:"#F3F9FF",fillOpacity:.5,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]}};function _e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function we(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?_e(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_e(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var Se={getDefaultCfg:function(){return{}},getEvents:function(){return{"canvas:mouseenter":"onCanvasMouseenter","canvas:mousedown":"onCanvasMousedown",mousemove:"onMousemove",mouseup:"onMouseup"}},onCanvasMouseenter:function(){var t=document.getElementById("graph-container").children[0];t.style.cursor="crosshair"},onCanvasMousedown:function(t){var e=be.delegateStyle,n=0,a=0,i=t.x,o=t.y,r=this.graph.get("group");ne["a"].dispatch("app/uniqueId"),this.shape=r.addShape("rect",{attrs:we({id:"rect"+ne["a"].state.app.max_id,width:n,height:a,x:i,y:o},e)})},onMousemove:function(t){if(this.shape){var e=t.x-this.shape._attrs.x,n=t.y-this.shape._attrs.y;this.shape.attr({width:e,height:n}),this.graph.paint()}},onMouseup:function(){var t=this,e=document.getElementById("graph-container").children[0];e.style.cursor="default";var n=this.graph.findAllByState("node","selected");h.a.each(n,function(e){t.graph.setItemState(e,"selected",!1),d["a"].$emit("nodeselectchange",{target:e,select:!1})}),this.shape&&(this.addTeam(),this.shape.remove(),this.shape=null),this.graph.paint(),d["a"].$emit("muliteSelectEnd"),this.graph.setMode("default")},addTeam:function(){var t=this,e=this.shape._attrs,n=e.x,a=e.y,i=e.width,o=e.height,r=p(n,a,i,o),s=r.x1,c=r.y1,l=r.x2,d=r.y2;this.graph.findAll("node",function(e){var n=e.getBBox(),a=n.x,i=n.y,o=n.width,r=n.height,u=p(a,i,o,r);l>=u.x1&&u.x1>=s&&l>=u.x2&&u.x2>=s&&d>=u.y1&&u.y1>=c&&d>=u.y2&&u.y2>=c&&t.graph.setItemState(e,"selected",!0)})}},Ee={getEvents:function(){return{"node:contextmenu":"onContextmenu",mousedown:"onMousedown","canvas:click":"onCanvasClick"}},onContextmenu:function(t){d["a"].$emit("contextmenuClick",t)},onMousedown:function(t){d["a"].$emit("mousedown",t)},onCanvasClick:function(t){d["a"].$emit("canvasClick",t)}},Oe=.05,xe={getDefaultCfg:function(){return{sensitivity:2,minZoom:.1,maxZoom:10}},getEvents:function(){return{wheel:"onWheel"}},onWheel:function(t){if(t.preventDefault(),this.shouldUpdate.call(this,t)){var e=this.graph,n=e.get("canvas"),a=n.getPointByClient(t.clientX,t.clientY),i=this.get("sensitivity"),o=e.getZoom();o=t.wheelDelta<0?1-Oe*i:1+Oe*i;var r=o*e.getZoom();r>this.get("maxZoom")||r<this.get("minZoom")||(e.zoom(o,{x:a.x,y:a.y}),e.paint(),e.emit("wheelzoom",t))}}},Ie={getEvents:function(){return{"canvas:dragstart":"ondblclick","canvas:mouseup":"onmouseout"}},ondblclick:function(t){console.log("drag start")},onmouseout:function(t){this.graph.setMode("default")}},ke=(n("6762"),Math.min),Pe=Math.max,Ae=Math.abs,De="shift",je=["drag","shift","ctrl","alt","control"],Ce={getDefaultCfg:function(){return{brushStyle:{fill:"#EEF6FF",fillOpacity:.4,stroke:"#DDEEFE",lineWidth:1},onSelect:function(){},onDeselect:function(){},selectedState:"selected",trigger:De,includeEdges:!0,selectedEdges:[],selectedNodes:[]}},getEvents:function(){var t;return je.indexOf(this.trigger.toLowerCase())>-1?t=this.trigger:(t=De,console.warn("Behavior brush-select的trigger参数不合法，请输入drag、shift、ctrl或alt")),"drag"===t?{mousedown:"onMouseDown",mousemove:"onMouseMove",mouseup:"onMouseUp","canvas:click":"clearStates"}:{mousedown:"onMouseDown",mousemove:"onMouseMove",mouseup:"onMouseUp","canvas:click":"clearStates",keyup:"onKeyUp",keydown:"onKeyDown"}},onMouseDown:function(t){var e=t.item;if(!e&&("drag"===this.trigger||this.keydown)){this.selectedNodes&&0!==this.selectedNodes.length&&this.clearStates();var n=this.brush;n||(n=this._createBrush()),this.originPoint={x:t.canvasX,y:t.canvasY},n.attr({width:0,height:0}),n.show(),this.dragging=!0}},onMouseMove:function(t){this.dragging&&("drag"===this.trigger||this.keydown)&&(this._updateBrush(t),this.graph.paint())},onMouseUp:function(t){if((this.brush||this.dragging)&&("drag"===this.trigger||this.keydown)){var e=this.graph,n=e.get("autoPaint");e.setAutoPaint(!1),this.brush.destroy(),this.brush=null,this._getSelectedNodes(t),d["a"].$emit("muliteSelectEnd"),this.dragging=!1,this.graph.paint(),e.setAutoPaint(n),"drag"===this.trigger&&this.graph.setMode("default")}},clearStates:function(){var t=this.graph,e=t.get("autoPaint");t.setAutoPaint(!1);var n=this.selectedState,a=t.findAllByState("node",n),i=t.findAllByState("edge",n);a.forEach(function(e){return t.setItemState(e,n,!1)}),i.forEach(function(e){return t.setItemState(e,n,!1)}),this.selectedNodes=[],this.selectedEdges=[],this.onDeselect&&this.onDeselect(this.selectedNodes,this.selectedEdges),t.emit("nodeselectchange",{targets:{nodes:[],edges:[]},select:!1}),d["a"].$emit("nodeselectchange",{targets:{nodes:[],edges:[]},select:!1}),t.paint(),t.setAutoPaint(e)},_getSelectedNodes:function(t){var e=this,n=this.graph,a=this.selectedState,i=this.originPoint,o={x:t.x,y:t.y},r=n.getPointByCanvas(i.x,i.y),s=ke(o.x,r.x),c=Pe(o.x,r.x),l=ke(o.y,r.y),d=Pe(o.y,r.y),u=[],h=this.shouldUpdate,p=[];n.getNodes().forEach(function(t){var e=t.getBBox();if(e.centerX>=s&&e.centerX<=c&&e.centerY>=l&&e.centerY<=d&&h(t,"select")){u.push(t);var i=t.getModel();p.push(i.id),n.setItemState(t,a,!0)}});var f=[];this.includeEdges&&u.forEach(function(t){var a=t.getEdges();a.forEach(function(t){var a=t.getModel(),i=a.source,o=a.target;p.includes(i)&&p.includes(o)&&h(t,"select")&&(f.push(t),n.setItemState(t,e.selectedState,!0))})}),this.selectedEdges=f,this.selectedNodes=u,this.onSelect&&this.onSelect(u,f),n.emit("nodeselectchange",{targets:{nodes:u,edges:f},select:!0})},_createBrush:function(){var t=this,e=t.graph.get("canvas").addShape("rect",{attrs:t.brushStyle,capture:!1});return this.brush=e,e},_updateBrush:function(t){var e=this.originPoint;this.brush.attr({width:Ae(t.canvasX-e.x),height:Ae(t.canvasY-e.y),x:ke(t.canvasX,e.x),y:ke(t.canvasY,e.y)})},onKeyDown:function(t){var e=t.key;e&&(e.toLowerCase()===this.trigger.toLowerCase()||"control"===e.toLowerCase()?this.keydown=!0:this.keydown=!1)},onKeyUp:function(){this.brush&&(this.brush.destroy(),this.brush=null,this.dragging=!1),this.keydown=!1}},Te={"hover-node":ee,"add-edge":le,"drag-item":ge,"select-node":me,"hover-edge":ve,keyboard:ye,"mulit-select":Se,"add-menu":Ee,"canvas-zoom":xe,"drag-select":Ce,"custom-events":Ie};function Me(){for(var t in Te)te.a.registerBehavior(t,Te[t])}function Ne(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function Le(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?Ne(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ne(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var We={data:function(){return{pageId:"graph-container",graph:null,data:null,max_id:0}},computed:Le({},Object(g["b"])(["canvasHeight","canvasWidth","itemWidth","detailWidth"]),{id:{get:function(){var t=this.$route.params.id;return this.$store.commit("app/SET_GRAPHID",t),t},set:function(t){this.$store.commit("app/SET_GRAPHID",t)}},isRunning:{get:function(){return this.$store.state.app.is_running},set:function(t){this.$store.commit("app/SET_ISRUNNING",t)}}}),watch:{canvasWidth:function(t){this.graph.changeSize(t,this.canvasHeight)},canvasHeight:function(t){console.log("canvas height change detected: ",t),this.graph.changeSize(this.canvasWidth,t)}},created:function(){Me(),this.getGraph(),this.$store.dispatch("app/getProjectFileList",this.id)},mounted:function(){var t=this;this.$nextTick(function(){t.init()})},methods:{getGraph:function(){var t=this;f["a"].getGraphById({graphId:this.id}).then(function(e){t.data=e.data,t.isRunning="loading"==t.data.status,t.forEach(t.data),t.$store.commit("app/SET_MAXID",t.max_id),t.graph.read(t.data),t.data.nodes.length&&t.graph.fitView(100)}).catch(function(e){Object(m["Message"])({message:e.data,type:"error",duration:3e3}),t.$router.push("/")})},forEach:function(t){for(var e in t)"id"===e&&"string"===typeof t[e]&&(this.max_id=Math.max(this.max_id,parseInt(t[e].replace(/[^0-9]/gi,"")))),"object"==Object(c["a"])(t[e])&&null!==t[e]&&this.forEach(t[e])},init:function(){var t=this.canvasHeight,e=this.canvasWidth;this.graph=new te.a.Graph({container:"graph-container",height:t,width:e,modes:{default:["drag-canvas","drag-select","canvas-zoom","hover-node","drag-node","select-node","hover-edge","keyboard","add-menu"],moveCanvas:["drag-canvas"],multiSelect:[{type:"drag-select",trigger:"drag"}],addEdge:["add-edge"]}});var n=this.$parent,a=n.editor,i=n.command;a.emit("afterAddPage",{graph:this.graph,command:i}),this.readData()},readData:function(){var t=this.data;t&&this.graph.read(t)},clickCanvas:function(){this.$store.dispatch("app/setIsFocusCanvas",!0)},handleDrop:function(t){this.$store.commit("app/SET_ALLOWDROP",!0)}}},Be=We,Ue=Object(x["a"])(Be,Yt,Jt,!1,null,"dca24d70",null),Fe=Ue.exports,He=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div")},ze=[],Re=n("3c4c"),Xe=n.n(Re),$e=n("1e31"),Ke=n.n($e),Ge={init:function(){te.a.registerNode("customNode",{draw:function(t,e){var n=t.size;n||(n=[170,34]);var a=parseInt(n[0]),i=parseInt(n[1]),o=t.color,r=-a/2,s=-i/2;ne["a"].dispatch("app/uniqueId");var c="rect"+ne["a"].state.app.max_id,l=e.addShape("rect",{attrs:{id:c,x:r,y:s,width:a,height:i,stroke:"#ced4d9",fill:"#fff",radius:4}});if(e.addShape("rect",{attrs:{x:r,y:s,width:4,height:i,fill:o,parent:c,radius:[4,0,0,4]}}),e.addShape("image",{attrs:{x:r+16,y:s+8,width:20,height:16,img:t.image,parent:c}}),t.status&&e.addShape("image",{attrs:{x:r+a-32,y:s+8,width:16,height:16,parent:c,img:"complete"==t.status?Q.a:"loading"==t.status?Ke.a:""}}),t.backImage){var d=new Xe.a.Rect({attrs:{x:r,y:s,width:a,height:i,fill:"#fff",radius:4}});e.addShape("image",{attrs:{x:r,y:s,width:a,height:i,img:t.backImage,clip:d}})}return t.node_detail.forEach(function(t){"name"==t.name&&(ne["a"].dispatch("app/uniqueId"),e.addShape("text",{attrs:{id:"label"+ne["a"].state.app.max_id,x:r+a/2,y:s+i/2,textAlign:"center",textBaseline:"middle",text:t.value,parent:c,fill:"#565758"}}))}),t.point_detail&&t.point_detail.forEach(function(t){var n,o=0;if("input"===t.type){o=0,n=a*t.proportion,ne["a"].dispatch("app/uniqueId");var c=ne["a"].state.app.max_id;ne["a"].dispatch("app/uniqueId");var l=t.id?t.id:"circle"+ne["a"].state.app.max_id;e.addShape("circle",{attrs:{id:"circle"+c,parent:l,x:n+r,y:o+s,r:10,isInPointOut:!0,func:t.func,fill:"#1890ff",opacity:0}}),e.addShape("circle",{attrs:{id:l,x:n+r,y:o+s,r:3,isInPoint:!0,func:t.func,fill:"#fff",stroke:"#1890ff",opacity:0}}),t.id=l}else if("output"===t.type){o=i,n=a*t.proportion,ne["a"].dispatch("app/uniqueId");var d=ne["a"].state.app.max_id;ne["a"].dispatch("app/uniqueId");var u=t.id?t.id:"circle"+ne["a"].state.app.max_id;e.addShape("circle",{attrs:{id:"circle"+d,parent:u,x:n+r,y:o+s,r:10,isOutPointOut:!0,func:t.func,fill:"#1890ff",opacity:0}}),e.addShape("text",{attrs:{size:12,parent:u,x:n+r,y:o+s+15,isOutPointText:!0,textAlign:"center",textBaseline:"bottom",text:t.name,fill:"#1890ff",opacity:0}}),e.addShape("circle",{attrs:{id:u,x:n+r,y:o+s,r:3,isOutPoint:!0,func:t.func,fill:"#fff",stroke:"#1890ff",opacity:0}}),t.id=u}}),l},setState:function(t,e,n){var a=n.getContainer(),i=a.get("children")[0],o=a.findAll(function(t){return t._attrs.parent===i._attrs.id}),r=a.findAll(function(t){return t._attrs.isInPoint||t._attrs.isOutPoint}),s=function(){i.attr("fill","#f3f9ff"),i.attr("stroke","#6ab7ff"),i.attr("cursor","move"),o.forEach(function(t){t.attr("cursor","move")}),r.forEach(function(t){t.attr("opacity",1)})},c=function(){i.attr("fill","#fff"),i.attr("stroke","#ced4d9"),r.forEach(function(t){t.attr("opacity",0)})};switch(t){case"selected":case"hover":e?s():c();break}}})}},Ve=Ge,Qe=3,qe={init:function(){var t=[[0,1],[0,2],[1,2],[0,1,1,2],[0,2,1,2],[1,2,1,2],[2,2,1,2],[3,2,1,2],[4,2,1,2]],e=[4,2,1,2],n=9;te.a.registerEdge("customEdge",{draw:function(t,e){var n,a,i,o;"string"===typeof t.source&&(t.source=t.sourceNode),t.start||(t.start={x:0,y:17}),t.end||(t.end={x:0,y:-17}),t.source.x?i=t.source:(n=t.source.getModel(),i={x:n.x+t.start.x,y:n.y+t.start.y}),"string"===typeof t.target&&(t.target=t.targetNode),t.target.x?o=t.target:(a=t.target.getModel(),o={x:a.x+t.end.x,y:a.y+t.end.y});var r=[],s=Math.abs(o.x-i.x);r=(o.x,i.x,[["M",i.x,i.y],["C",i.x,i.y+s/(s/50),o.x,o.y-s/(s/50),o.x,o.y-4],["L",o.x,o.y]]);var c=1;c=c>Qe?c:Qe;var l=10*c/3,d=4*c/3,u=4*c,h=[["M",-l,d],["L",0,0],["L",-l,-d],["A",u,u,0,0,1,-l,d],["Z"]];ne["a"].dispatch("app/uniqueId");var p,f=e.addShape("path",{attrs:{id:"edge"+ne["a"].state.app.max_id,path:r,stroke:"#b8c3ce",lineAppendWidth:10,endArrow:{path:h}}});return n.point_detail.forEach(function(e){e.id==t.startPointId&&(p=e)}),e.addShape("text",{attrs:{text:p.name,fill:"#595959",textAlign:"start",textBaseline:"middle",x:(i.x+o.x)/2,y:(i.y+o.y)/2}}),f},afterDraw:function(a,i){if(a.source.getModel().isDoingStart&&a.target.getModel().isDoingEnd){for(var o=i.get("children")[0],r=o.getTotalLength(),s=[],c=0;c<r;c+=n)s=s.concat(e);var l=0;o.animate({onFrame:function(){var e={lineDash:t[l].concat(s)};return l=(l+1)%n,e},repeat:!0},3e3)}},setState:function(t,e,n){var a=n.getContainer(),i=a.get("children")[0],o=function(){i.attr("stroke","#6ab7ff")},r=function(){i.attr("stroke","#b8c3ce")};switch(t){case"selected":case"hover":e?o():r();break}}}),te.a.registerEdge("link-edge",{draw:function(t,e){var n,a,i,o;t.source.x?i=t.source:(n=t.source.getModel(),i={x:n.x+t.start.x,y:n.y+t.start.y}),t.target.x?o=t.target:(a=t.target.getModel(),o={x:a.x+t.end.x,y:a.y+t.end.y});var r=[];r=[["M",i.x,i.y],["L",o.x,o.y]],ne["a"].dispatch("app/uniqueId");var s=e.addShape("path",{attrs:{id:"edge"+ne["a"].state.app.max_id,path:r,stroke:"#1890FF",strokeOpacity:.9,lineDash:[5,5]}});return s}})}},Ye=qe,Je=(n("b167"),n("8b1b")),Ze=n.n(Je),tn={init:function(){te.a.registerNode("teamNode",{draw:function(t,e){var n=10,a=20,i=t.width+2*n,o=t.height+2*n,r=-i/2,s=-o/2-a;ne["a"].dispatch("app/uniqueId");var c="rect"+ne["a"].state.app.max_id,l=e.addShape("rect",{attrs:{id:c,x:r,y:s,width:i,height:o+a,stroke:"#ced4d9",fill:"#f2f4f5",radius:4}});return ne["a"].dispatch("app/uniqueId"),e.addShape("text",{attrs:{id:"label"+ne["a"].state.app.max_id,x:r+n,y:s+n,textBaseline:"top",text:t.label||"新建分组",parent:c,fill:"#565758"}}),e.addShape("image",{attrs:{x:r+i-26,y:s+8,width:16,height:16,img:Ze.a}}),l},setState:function(t,e,n){var a=n.getContainer(),i=a.get("children")[0],o=function(){i.attr("stroke","#6ab7ff"),i.attr("cursor","move")},r=function(){i.attr("stroke","#ced4d9")};switch(t){case"selected":case"hover":e?o():r();break}}})}},en=tn,nn={name:"Flow",data:function(){return{page:null}},created:function(){this.init()},methods:{init:function(){Ve.init(),Ye.init(),en.init()}}},an=nn,on=Object(x["a"])(an,He,ze,!1,null,null,null),rn=on.exports,sn=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("ul",{ref:"contextMenu",staticClass:"el-scrollbar__view el-select-dropdown__list context-menu"},t._l(t.menus,function(e){return n("li",{key:e.key,staticClass:"el-select-dropdown__item",on:{click:function(n){return t.handleClick(e)}}},[t._v(t._s(e.name))])}),0)])},cn=[],ln={data:function(){return{menus:[{key:1,name:"菜单1"},{key:2,name:"菜单2"}]}},created:function(){this.bindEvent()},methods:{init:function(){},bindEvent:function(){},handleClick:function(t){alert(t.name);var e=this.$refs.contextMenu;e.style.display="none"}}},dn=ln,un=(n("9031"),Object(x["a"])(dn,sn,cn,!1,null,null,null)),hn=un.exports,pn=n("d225"),fn=n("b0b4"),gn=function(){function t(){Object(pn["a"])(this,t),ne["a"].dispatch("app/uniqueId"),this.id=ne["a"].state.app.max_id}return Object(fn["a"])(t,[{key:"getGrpah",value:function(){return this.graph}},{key:"emit",value:function(t,e){"afterAddPage"===t&&(this.graph=e.graph),d["a"].$emit(t,e)}},{key:"on",value:function(t){switch(t){case"changeNodeData":this.graph.refresh();break}}},{key:"add",value:function(t,e){this.graph.add(t,e)}},{key:"update",value:function(t,e){this.graph.update(t,e)}},{key:"remove",value:function(t){var e=this.graph.findById(t.id);this.graph.remove(e)}}]),t}(),mn=function(){function t(e){Object(pn["a"])(this,t),Object(o["a"])(this,"editor",null),Object(o["a"])(this,"undoList",[]),Object(o["a"])(this,"redoList",[]),this.editor=e}return Object(fn["a"])(t,[{key:"executeCommand",value:function(t,e){var n=this,a=[];e.map(function(e){var i=e;if("add"===t&&(ne["a"].dispatch("app/uniqueId"),i.id=e.type+ne["a"].state.app.max_id),"delete"===t){if("node"===e.getType()){var o=e.getEdges();i=e.getModel(),i.type=e.getType(),i.id=e.get("id"),o.forEach(function(t){var e=t.getModel();e.type="edge",e.id=t.get("id"),a.push(e)})}else"edge"===e.getType()&&(i=e.getModel(),i.type=e.getType(),i.id=e.get("id"));d["a"].$emit("nodeselectchange",{select:!1})}a.push(i),n.doCommand(t,i)}),this.undoList.push({key:t,datas:a}),"delete"===t&&(this.redoList=[]),this.editor.emit(t,{undoList:this.undoList,redoList:this.redoList})}},{key:"doCommand",value:function(t,e){switch(t){case"add":this.add(e.type,e);break;case"update":this.update(e.item,e.newModel);break;case"delete":this.remove(e);break}}},{key:"add",value:function(t,e){this.editor.add(t,e)}},{key:"update",value:function(t,e){this.editor.update(t,e)}},{key:"remove",value:function(t){this.editor.remove(t)}},{key:"undo",value:function(){for(var t=this.undoList.pop(),e=[],n=[],a=0;a<t.datas.length;a++){var i=t.datas[a];"edge"!==i.type?(n.push(i),this.doundo(t.key,i)):e.push(i)}for(var o=0;o<e.length;o++){var r=e[o];r.source.destroyed&&(r.source=r.sourceId),r.target.destroyed&&(r.target=r.targetId),n.push(r),this.doundo(t.key,r)}this.redoList.push({key:t.key,datas:n}),this.editor.emit(t.key,{undoList:this.undoList,redoList:this.redoList})}},{key:"doundo",value:function(t,e){switch(t){case"add":this.remove(e);break;case"update":this.update(e.item,e.oldModel);break;case"delete":this.add(e.type,e);break}}},{key:"redo",value:function(){for(var t=this.redoList.pop(),e=[],n=[],a=0;a<t.datas.length;a++){var i=t.datas[a];"edge"!==i.type?(e.push(i),this.doredo(t.key,i)):n.push(i)}for(var o=0;o<n.length;o++){var r=n[o];r.source.destroyed&&(r.source=r.sourceId),r.target.destroyed&&(r.target=r.targetId),e.push(r),this.doredo(t.key,r)}this.undoList.push({key:t.key,datas:e}),this.editor.emit(t.key,{undoList:this.undoList,redoList:this.redoList})}},{key:"doredo",value:function(t,e){switch(t){case"add":this.add(e.type,e);break;case"update":this.update(e.item,e.newModel);break;case"delete":this.remove(e);break}}},{key:"delete",value:function(t){this.executeCommand("delete",[t])}}]),t}(),vn=mn;function yn(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function bn(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?yn(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):yn(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var _n={name:"G6Editor",components:{Toolbar:H,ItemPanel:rt,DetailPanel:Ft,Minimap:qt,Page:Fe,ContextMenu:hn,Flow:rn},computed:bn({},Object(g["b"])(["docHeight","tbHeight"]),{container_height:function(){return this.docHeight-this.tbHeight},id:{get:function(){var t=this.$router.params.id;return this.$store.commit("app/SET_GRAPHID",t),t},set:function(t){this.$store.commit("app/SET_GRAPHID",t)}}}),created:function(){this.init()},data:function(){return{editor:{},command:null}},methods:{init:function(){this.editor=new gn,this.command=new vn(this.editor)}}},wn=_n,Sn=(n("80ce"),Object(x["a"])(wn,a,i,!1,null,"37626806",null));e["default"]=Sn.exports},4323:function(t,e,n){},4360:function(t,e,n){"use strict";n("a481"),n("ac6a");var a=n("2b0e"),i=n("2f62"),o={isFocusCanvas:function(t){return t.app.is_focus_canvas},canvasWidth:function(t){return t.app.canvas_width},canvasHeight:function(t){return t.app.canvas_height},detailWidth:function(t){return t.app.detailpannel_width},itemWidth:function(t){return t.app.itempannel_width},isAllowDrop:function(t){return t.app.allow_drop},isAllowSave:function(t){return t.app.allow_save},selectedNodeId:function(t){return t.app.selected_node_id},isRunning:function(t){return t.app.is_running},docWidth:function(t){return t.app.document_width},docHeight:function(t){return t.app.document_height},tbHeight:function(t){return t.app.topbar_height},fileList:function(t){return t.app.file_list},nodeList:function(t){return t.app.node_list},categories:function(t){return t.app.category},isShowPreview:function(t){return t.app.is_show_preview},isShowVisual:function(t){return t.app.is_show_visual},isShowEcharts:function(t){return t.app.is_show_echarts},graphId:function(t){return t.app.graph_id},token:function(t){return t.user.token},username:function(t){return t.user.username}},r=o;a["default"].use(i["a"]);var s=n("c653"),c=s.keys().reduce(function(t,e){var n=e.replace(/^\.\/(.*)\.\w+$/,"$1"),a=s(e);return t[n]=a.default,t},{}),l=new i["a"].Store({modules:c,getters:r});e["a"]=l},4691:function(t,e,n){"use strict";var a=n("86fa"),i=n.n(a);i.a},5166:function(t,e,n){"use strict";var a=n("5cfc"),i=n.n(a);i.a},"56d7":function(t,e,n){"use strict";n.r(e);n("7f7f"),n("cadf"),n("551c"),n("f751"),n("097d");var a=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{attrs:{id:"app"}},[n("Header"),t._v(" "),n("router-view")],1)},i=[],o=(n("8e6e"),n("ac6a"),n("456d"),n("bd86")),r=n("41d6"),s=n("4360"),c=document,l=c.body,d={beforeMount:function(){window.addEventListener("resize",this.resizeHandler)},methods:{resizeHandler:function(){s["a"].dispatch("app/setDocument",{document_width:document.documentElement.clientWidth,document_height:document.documentElement.clientHeight})}},BODY:l},u=n("d23d"),h=n("2f62"),p=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"header"},[a("el-menu",{staticClass:"el-menu-demo",attrs:{"default-active":t.activeIndex,mode:"horizontal"},on:{select:t.handleSelect}},[a("el-menu-item",{attrs:{index:"2"}},[a("el-link",{attrs:{href:"#"}},[t._v("首页")])],1),t._v(" "),a("el-menu-item",{attrs:{index:"1"}},[a("el-link",{attrs:{href:"/flow/#/project"}},[t._v("项目中心")])],1),t._v(" "),a("el-submenu",{staticStyle:{float:"right"},attrs:{index:"5"}},[a("template",{slot:"title"},[a("img",{staticClass:"user-avatar",attrs:{src:n("aca7"),alt:"avatar"}}),t._v(" "),a("span",{staticClass:"user-avatar-span"},[t._v(t._s(t.username))])]),t._v(" "),a("el-menu-item",{attrs:{index:"5-1"}},[a("i",{staticClass:"iconfont icon-gerenzhongxin"}),t._v(" "),a("el-link",{attrs:{href:"/flow/#/personal/7"}},[t._v("个人中心")])],1),t._v(" "),a("el-menu-item",{attrs:{index:"5-3"},on:{click:t.logout}},[a("i",{staticClass:"iconfont icon-tuichu"}),t._v(" "),a("span",[t._v("退出")])])],2),t._v(" "),a("el-submenu",{staticStyle:{float:"right"},attrs:{index:"4"}},[a("template",{slot:"title"},[a("svg",{staticClass:"ant-dropdown-trigger Header-module--translation--Px2mu",attrs:{width:"24",height:"24",viewBox:"0 0 24 24"}},[a("path",{attrs:{d:"M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z"}})])]),t._v(" "),a("el-menu-item",{attrs:{index:"4-1"}},[t._v("简体中文")]),t._v(" "),a("el-menu-item",{attrs:{index:"4-2"}},[t._v("繁体中文")]),t._v(" "),a("el-menu-item",{attrs:{index:"4-3"}},[t._v("English")])],2)],1)],1)},f=[];function g(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function m(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?g(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var v={name:"Header",data:function(){return{activeIndex:"1",activeIndex2:"1",circleUrl:"@/assets/img/logo.jpg"}},methods:{handleSelect:function(t,e){console.log(t,e)},logout:function(){var t=this;this.$store.dispatch("user/Logout").then(function(e){t.$router.push("/login")})}},computed:m({},Object(h["b"])(["token","username"]))},y=v,b=(n("5166"),n("2877")),_=Object(b["a"])(y,p,f,!1,null,"0c4c0481",null),w=_.exports;function S(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(t);e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,a)}return n}function E(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?S(n,!0).forEach(function(e){Object(o["a"])(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):S(n).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}var O={name:"app",components:{G6Editor:r["default"],Header:w},mixins:[d,u["a"]],computed:E({},Object(h["b"])(["token"])),created:function(){this.token&&u["a"].initWebSocket(),this.$store.dispatch("app/getCategory"),this.$store.dispatch("app/getNodeList")}},x=O,I=(n("034f"),Object(b["a"])(x,a,i,!1,null,null,null)),k=I.exports,P=n("2b0e"),A=n("a18c"),D=n("5c96"),j=n.n(D),C=(n("0fae"),n("d168")),T=n.n(C),M=n("bc3a"),N=n.n(M),L=n("c3da"),W=n.n(L),B=n("7fe0"),U=n.n(B),F=(n("96cf"),n("3b8d")),H=n("5f87"),z=["/login","/register"];A["a"].beforeEach(function(){var t=Object(F["a"])(regeneratorRuntime.mark(function t(e,n,a){var i;return regeneratorRuntime.wrap(function(t){while(1)switch(t.prev=t.next){case 0:if(i=H["a"].getToken(),!i){t.next=17;break}if("/login"!==e.path&&"/register"!==e.path){t.next=6;break}a({path:"/"}),t.next=15;break;case 6:t.prev=6,a(),t.next=15;break;case 10:return t.prev=10,t.t0=t["catch"](6),t.next=14,s["a"].dispatch("user/Logout");case 14:a("/login?redirect=".concat(e.path));case 15:t.next=18;break;case 17:-1!==z.indexOf(e.path)?a():a("/login?redirect=".concat(e.path));case 18:case"end":return t.stop()}},t,null,[[6,10]])}));return function(e,n,a){return t.apply(this,arguments)}}()),P["default"].config.productionTip=!1,P["default"].use(j.a,{size:"mini"}),P["default"].use(T.a),P["default"].component(W.a.name,W.a),P["default"].component(U.a.name,U.a),P["default"].prototype.axios=N.a,new P["default"]({render:function(t){return t(k)},router:A["a"],store:s["a"]}).$mount("#app")},"5cfc":function(t,e,n){},"5f87":function(t,e,n){"use strict";var a=n("a78e"),i=n.n(a),o=new Date((new Date).getTime()+2592e5);e["a"]={setToken:function(t){return i.a.set("token",t,{expires:o})},getToken:function(){return i.a.get("token")},removeToken:function(){i.a.remove("token")}}},"64a9":function(t,e,n){},6763:function(t,e,n){"use strict";var a=n("3c6d"),i=n.n(a);i.a},"6f04":function(t,e,n){"use strict";var a=n("09f0"),i=n.n(a);i.a},7959:function(t,e,n){},"80ce":function(t,e,n){"use strict";var a=n("1952"),i=n.n(a);i.a},8301:function(t,e,n){"use strict";var a=n("106c"),i=n.n(a);i.a},"86d5":function(t,e,n){t.exports=n.p+"assets/img/bg.9a8b47e5.jpg"},"86fa":function(t,e,n){},"8b1b":function(t,e,n){t.exports=n.p+"assets/img/close.d18d59d7.svg"},9031:function(t,e,n){"use strict";var a=n("cda8"),i=n.n(a);i.a},"986e":function(t,e,n){"use strict";var a=n("2b0e");e["a"]=new a["default"]},a18c:function(t,e,n){"use strict";var a=n("2b0e"),i=n("8c4f"),o=function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",[n("router-view",{key:t.key})],1)},r=[],s={name:"Layout",computed:{key:function(){return this.$route.path}},methods:{}},c=s,l=n("2877"),d=Object(l["a"])(c,o,r,!1,null,null,null),u=d.exports;a["default"].use(i["a"]);e["a"]=new i["a"]({mode:"hash",routes:[{path:"/",component:u,redirect:"/project",children:[{path:"project",component:function(){return n.e("chunk-d09d026a").then(n.bind(null,"707c"))},name:"Project"}]},{path:"/graph/",component:u,hidden:!0,children:[{path:":id",component:function(){return Promise.resolve().then(n.bind(null,"41d6"))},name:"Graph"}]},{path:"/personal/",component:u,hidden:!0,children:[{path:":id",component:function(){return n.e("chunk-25112b8c").then(n.bind(null,"f8ae"))},name:"PersonalCenter"}]},{path:"*",name:"NotFound",redirect:"/project"},{path:"/login",component:function(){return n.e("chunk-2db84a18").then(n.bind(null,"9ed6"))}},{path:"/register",component:function(){return n.e("chunk-e48c52a0").then(n.bind(null,"d5c2"))}}]})},aca7:function(t,e){t.exports="data:image/jpeg;base64,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"},b167:function(t,e,n){t.exports=n.p+"assets/img/open.6dcd87be.svg"},b775:function(t,e,n){"use strict";var a=n("bc3a"),i=n.n(a),o=n("d6dd"),r=n("4360"),s=n("a18c"),c=n("e32a"),l=n("5c96"),d=n("5f87"),u=i.a.create({baseURL:c["a"].BASE_API,withCredentials:!0});u.interceptors.request.use(function(t){if(d["a"].getToken()){var e=o["a"].payload_decode(d["a"].getToken()),n=Date.parse(new Date);if(n/1e3>e.exp)return r["a"].dispatch("user/Logout"),s["a"].push("/login"),Promise.reject({response:{data:"signature expire"}});t.headers["Authorization"]="JWT "+d["a"].getToken()}return t},function(t){return console.log(t),Promise.reject(t)}),u.interceptors.response.use(function(t){return 202==t.status||201==t.status||200==t.status?Promise.resolve(t.data):(Object(l["Message"])({message:t.data,type:"error",duration:3e3}),Promise.reject(t.data))},function(t){return Promise.reject(t.response.data)}),e["a"]=u},c0fa:function(t,e,n){"use strict";var a=n("4323"),i=n.n(a);i.a},c24f:function(t,e,n){"use strict";var a=n("b775");e["a"]={login:function(t){return Object(a["a"])({url:"/user/login",method:"post",data:t})},register:function(t){return Object(a["a"])({url:"/user/register",method:"post",data:t})}}},c653:function(t,e,n){var a={"./app.js":"d9cd","./user.js":"0f9a"};function i(t){var e=o(t);return n(e)}function o(t){var e=a[t];if(!(e+1)){var n=new Error("Cannot find module '"+t+"'");throw n.code="MODULE_NOT_FOUND",n}return e}i.keys=function(){return Object.keys(a)},i.resolve=o,t.exports=i,i.id="c653"},cda8:function(t,e,n){},d23d:function(t,e,n){"use strict";var a=n("5c96"),i=n("986e"),o=n("4360"),r=n("e32a"),s=null;e["a"]={beforeMount:function(){console.log("before mount"),i["a"].$on("afterAddPage",function(t){s=t.graph})},initWebSocket:function(){this.websock=new WebSocket(r["a"].WS_API),this.websock.onopen=this.websocketOnOpen,this.websock.onerror=this.websocketOnError,this.websock.onmessage=this.websocketOnMessage,this.websock.onclose=this.websocketClose},websocketOnOpen:function(){console.log("websocket connected")},websocketOnError:function(){console.log("websocket error")},websocketOnMessage:function(t){var e=JSON.parse(t.data).msg;if("complete"===e)o["a"].commit("app/SET_ISRUNNING",!1),Object(a["Notification"])({title:"成功",message:"项目运行成功",type:"success",duration:3e3});else{var n=e.nodeId,i=e.status,r=s.findById(n),c={status:i};s.update(r,c)}},websocketClose:function(t){this.websock&&(this.websock.send(JSON.stringify({msg:"close"})),this.websock=null,console.log("websocket disconnect"))},websocketSend:function(t){this.websock.send(JSON.stringify({data:t}))}}},d6dd:function(t,e,n){"use strict";n("6b54"),n("a481"),n("28a5");e["a"]={payload_decode:function(t){if("string"!==typeof t)throw"Invalid token specified";var e=t.split(".");if(3!=e.length)throw"Illegal JWT token.";var n=e[1],a=n.replace(/-/g,"+").replace(/_/g,"/");switch(a.length%4){case 0:break;case 2:a+="==";break;case 3:a+="=";break;default:throw"Illegal base64url string!"}var i=function(t){var e=String(t).replace(/=+$/,"");if(e.length%4==1)throw"The string to be decoded is not correctly encoded.";for(var n,a,i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",o=0,r=0,s="";a=e.charAt(r++);~a&&(n=o%4?64*n+a:a,o++%4)?s+=String.fromCharCode(255&n>>(-2*o&6)):0)a=i.indexOf(a);return s}(a).replace(/(.)/g,function(t,e){var n=e.charCodeAt(0).toString(16).toUpperCase();return"%"+(n.length<2?"0"+n:n)});return JSON.parse(decodeURIComponent(i))}}},d9cd:function(t,e,n){"use strict";n.r(e);var a=n("3f5e"),i=n("e74e"),o={is_focus_canvas:!1,document_width:document.documentElement.clientWidth,document_height:document.documentElement.clientHeight,topbar_height:42,canvas_width:document.documentElement.clientWidth-400,canvas_height:document.documentElement.clientHeight-42,detailpannel_width:200,itempannel_width:200,allow_drop:!1,allow_save:!0,selected_node_id:null,is_running:!1,is_show_node_manage:!1,file_list:[],node_list:[],category:[],is_show_preview:!1,is_show_visual:!1,is_show_echarts:!1,max_id:0,graph_id:0},r={SET_ISFOCUSCANVAS:function(t,e){t.is_focus_canvas=e},SET_DOCUMENTWIDTH:function(t,e){t.document_width=e},SET_DOCUMENTHEIGHT:function(t,e){t.document_height=e},SET_CANVASWIDTH:function(t,e){t.canvas_width=e},SET_CANVASHEIGHT:function(t,e){t.canvas_height=e},SET_DETAILPANNELWIDTH:function(t,e){t.detailpannel_width=e},SET_ITEMPANNELWIDTH:function(t,e){t.itempannel_width=e},SET_ALLOWDROP:function(t,e){t.allow_drop=e},SET_ALLOWSAVE:function(t,e){t.allow_save=e},SET_SETSELECTEDNODEID:function(t,e){t.selected_node_id=e},SET_ISRUNNING:function(t,e){t.is_running=e},SET_ISSHOWNODEMANAGE:function(t,e){t.is_show_node_manage=e},SET_FILELIST:function(t,e){t.file_list=e},SET_NODELIST:function(t,e){t.node_list=e},SET_CATEGORY:function(t,e){t.category=e},SET_ISSHOWPREVIEW:function(t,e){t.is_show_preview=e},SET_ISSHOWVISUAL:function(t,e){t.is_show_visual=e},SET_ISSHOWECHARTS:function(t,e){t.is_show_echarts=e},SET_MAXID:function(t,e){t.max_id=e},SET_GRAPHID:function(t,e){t.graph_id=e}},s={setIsFocusCanvas:function(t,e){var n=t.commit;n("SET_ISFOCUSCANVAS",e)},setCanvasWidth:function(t,e){var n=t.commit;n("SET_CANVASWIDTH",e)},setDetailPannelWidth:function(t,e){var n=t.commit,a=t.state;n("SET_DETAILPANNELWIDTH",e);var i=document.documentElement.clientWidth-a.detailpannel_width-a.itempannel_width;n("SET_CANVASWIDTH",i)},setItemPannelWidth:function(t,e){var n=t.commit,a=t.state;n("SET_ITEMPANNELWIDTH",e);var i=document.documentElement.clientWidth-a.detailpannel_width-a.itempannel_width;n("SET_CANVASWIDTH",i)},setDocument:function(t,e){var n=t.commit,a=e.document_width,i=e.document_height;n("SET_DOCUMENTWIDTH",a),n("SET_DOCUMENTHEIGHT",i);var r=a-o.detailpannel_width-o.itempannel_width,s=i-o.topbar_height;n("SET_CANVASWIDTH",r),n("SET_CANVASHEIGHT",s)},getProjectFileList:function(t,e){var n=t.commit;a["a"].getProjectFileList({graphId:e}).then(function(t){n("SET_FILELIST",t.data)})},getNodeList:function(t){var e=t.commit;i["a"].getNodeTemplate().then(function(t){e("SET_NODELIST",t.data)})},getCategory:function(t){var e=t.commit;i["a"].getCategory().then(function(t){e("SET_CATEGORY",t.data)})},uniqueId:function(t){var e=t.commit;return new Promise(function(t){e("SET_MAXID",o.max_id+1),t(o.max_id+1)})}};e["default"]={namespaced:!0,state:o,mutations:r,actions:s}},e32a:function(t,e,n){"use strict";e["a"]={BASE_API:"http://39.105.21.62/flow/api/",WS_API:"wss://39.105.21.62/flow/api/message"}},e74e:function(t,e,n){"use strict";var a=n("b775");e["a"]={uploadJson:function(t){return Object(a["a"])({url:"/upload_json",method:"post",data:t})},getGraphs:function(t){return Object(a["a"])({url:"/graph/",method:"get",params:t})},getGraphById:function(t){return Object(a["a"])({url:"/graph/",method:"get",params:t})},createGraph:function(t){return Object(a["a"])({url:"/graph/",method:"post",data:t})},deleteGraphs:function(t){return Object(a["a"])({url:"/graph/multiple_delete/",method:"delete",params:t})},sendGraph:function(t){return Object(a["a"])({url:"/graph/",method:"put",data:t})},getNodeTemplate:function(){return Object(a["a"])({url:"/node_template/",method:"get"})},runProject:function(t){return Object(a["a"])({url:"/run_project",method:"put",data:t})},runNode:function(t){return Object(a["a"])({url:"/run_node",method:"put",data:t})},getCategory:function(){return Object(a["a"])({url:"/category/",method:"get"})}}},ea21:function(t,e,n){"use strict";var a=n("2fad"),i=n.n(a);i.a},eee6:function(t,e,n){"use strict";var a=n("39d4"),i=n.n(a);i.a},fecb:function(t,e,n){t.exports=n.p+"assets/img/ok.463ab0e4.svg"}});